# CVE-2025-11539 Lab

> Grafana Image Renderer v4.0.16 — Arbitrary File Write / RCE

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc/poc.py` | Arbitrary file write via `/render` (PNG screenshot) |
| 2 | `poc/poc_vector2.py` | Full content control via `/render/csv` (attacker-hosted download) |
| 3 | `poc/poc_vector3.py` | Config overwrite — persistent auth token backdoor |

## Setup

```bash
cd CVE-2025-11539
docker compose up -d
```

Wait for both containers to be healthy (~15s).

**Ports:** `3000 → Grafana`, `8081 → Image Renderer`
**Credentials:** Renderer auth token: `-` (single hyphen via `X-Auth-Token` header)

## Run

```bash
python3 poc/poc.py localhost 8081
python3 poc/poc_vector2.py localhost 8081
python3 poc/poc_vector3.py localhost 8081
```

Note: Vector 3 overwrites `config.json` then auto-restores — run last.

## Teardown

```bash
docker compose down
```
