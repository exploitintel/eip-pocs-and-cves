# CVE-2025-66489 Lab

> Cal.com â€” Authentication Bypass via TOTP Code Injection

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc/poc.py` | Auth bypass with baseline comparison + session verification |
| 2 | `poc/poc_vector2_minimal_totp.py` | Edge-case totpCode values (truthy/falsy semantics) |
| 3 | `poc/poc_vector3_session_hijack.py` | Full account takeover via 6 sensitive API endpoints |

## Setup

```bash
cd CVE-2025-66489
docker compose up -d
```

Wait ~90s for Cal.com startup (529 DB migrations + app seed). Verify: `docker compose ps`

```bash
# Seed the test user (run after vulnerable container is healthy)
bash seed-test-user.sh
```

**Ports:** 3000 (Cal.com v5.9.7)
**Credentials:** `victim@example.com` / `Password123!`

## Run

```bash
# Primary auth bypass
python3 poc/poc.py localhost 3000 victim@example.com

# Edge-case totpCode values
python3 poc/poc_vector2_minimal_totp.py localhost 3000 victim@example.com

# Full account takeover
python3 poc/poc_vector3_session_hijack.py localhost 3000 victim@example.com
```

## Teardown

```bash
docker compose down -v
```
