# Druid single-node mode
DRUID_SINGLE_NODE_CONF=micro-quickstart

# Logging
druid_emitter_logging_logLevel=debug

# Extensions - INCLUDES druid-kerberos (required for CVE-2025-59390)
druid_extensions_loadList=["druid-histogram", "druid-datasketches", "druid-lookups-cached-global", "postgresql-metadata-storage", "druid-multi-stage-query", "druid-kerberos"]

# ZooKeeper
druid_zk_service_host=cve-2025-59390-zookeeper

# Metadata storage (PostgreSQL)
druid_metadata_storage_host=
druid_metadata_storage_type=postgresql
druid_metadata_storage_connector_connectURI=jdbc:postgresql://cve-2025-59390-postgres:5432/druid
druid_metadata_storage_connector_user=druid
druid_metadata_storage_connector_password=FoolishPassword

# Storage
druid_storage_type=local
druid_storage_storageDirectory=/opt/shared/segments
druid_indexer_logs_type=file
druid_indexer_logs_directory=/opt/shared/indexing-logs

# Processing
druid_processing_numThreads=2
druid_processing_numMergeBuffers=2

# Indexer
druid_indexer_runner_javaOptsArray=["-server", "-Xmx1g", "-Xms1g", "-XX:MaxDirectMemorySize=3g", "-Duser.timezone=UTC", "-Dfile.encoding=UTF-8", "-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager"]
druid_indexer_fork_property_druid_processing_buffer_sizeBytes=256MiB

# =============================================================================
# KERBEROS AUTHENTICATOR CONFIGURATION (VULNERABLE)
# =============================================================================
# Enable Kerberos authentication
druid_auth_authenticatorChain=["kerberos"]
druid_auth_authenticator_kerberos_type=kerberos
druid_auth_authenticator_kerberos_serverPrincipal=HTTP/cve-2025-59390-druid@EXAMPLE.COM
druid_auth_authenticator_kerberos_serverKeytab=/etc/security/keytabs/druid.keytab
druid_auth_authenticator_kerberos_authorizerName=allowAll

# =============================================================================
# CVE-2025-59390: cookieSignatureSecret is deliberately NOT SET
# This causes the vulnerable code path: ThreadLocalRandom.current().nextLong()
# is used to generate a weak HMAC-SHA256 signing secret for auth cookies.
# =============================================================================

# Authorization (allow all for lab simplicity)
druid_auth_authorizers=["allowAll"]
druid_auth_authorizer_allowAll_type=allowAll

# Log4j2 config
DRUID_LOG4J=<?xml version="1.0" encoding="UTF-8" ?><Configuration status="WARN"><Appenders><Console name="Console" target="SYSTEM_OUT"><PatternLayout pattern="%d{ISO8601} %p [%t] %c - %m%n"/></Console></Appenders><Loggers><Root level="info"><AppenderRef ref="Console"/></Root><Logger name="org.apache.druid.jetty.RequestLog" additivity="false" level="DEBUG"><AppenderRef ref="Console"/></Logger><Logger name="org.apache.druid.security.kerberos" additivity="false" level="WARN"><AppenderRef ref="Console"/></Logger></Loggers></Configuration>
