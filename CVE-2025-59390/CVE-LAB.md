# CVE-2025-59390 Lab

> Apache Druid — Kerberos Authentication Bypass (Weak PRNG Cookie Signing)

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc/poc.py` | Full chain: SPNEGO → JVM memory scan → cookie forgery → auth bypass |
| 2 | `poc/poc_vector2.py` | Cookie forgery from captured cookie (no JVM access) |
| 3 | `poc/poc_vector3.py` | ThreadLocalRandom cryptographic weakness demo (standalone) |

## Setup

```bash
cd CVE-2025-59390
docker compose build && docker compose up -d
```

Wait ~60s for Druid startup. Verify: `docker compose ps`

**Ports:** 8081 (Druid coordinator)
**Credentials:** `testuser@EXAMPLE.COM` / `testpassword` (Kerberos)

## Run

```bash
# Full exploit chain
python3 poc/poc.py localhost 8081 cve-2025-59390-druid cve-2025-59390-kdc

# Cookie forgery (use token, signature, and secret from poc.py output)
python3 poc/poc_vector2.py localhost 8081 "<token>" "<signature>" "<secret>"

# Standalone ThreadLocalRandom weakness demo
python3 poc/poc_vector3.py
```

## Teardown

```bash
docker compose down -v
```
