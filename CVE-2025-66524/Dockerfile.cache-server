FROM python:3.11-slim

COPY nifi_cache_server.py /srv/nifi_cache_server.py
COPY mock_asana_api.py /srv/mock_asana_api.py

# Run both servers with a simple supervisor script
COPY start-services.sh /srv/start-services.sh
RUN chmod +x /srv/start-services.sh

EXPOSE 4557 8888

# Ensure Python stdout/stderr is unbuffered for docker logs visibility
ENV PYTHONUNBUFFERED=1

CMD ["/srv/start-services.sh"]
