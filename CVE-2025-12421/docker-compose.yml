# docker-compose.yml â€” CVE-2025-12421 Lab Environment
#
# Mattermost v11.0.2 - Token Type Confusion to Account Takeover
#
# Usage:
#   docker compose build
#   docker compose up -d
#   docker compose down

services:
  vulnerable:
    build:
      context: .
      dockerfile: Dockerfile.vulnerable
    container_name: cve-2025-12421-vulnerable
    environment:
      POSTGRES_USER: mmuser
      POSTGRES_PASSWORD: mostest
      POSTGRES_DB: mattermost_test
      POSTGRES_HOST_AUTH_METHOD: trust
      MM_FEATUREFLAGS_MOBILESSOCODEEXCHANGE: "true"
      MM_EMAILSETTINGS_REQUIREEMAILVERIFICATION: "false"
      MM_TEAMSETTINGS_ENABLEOPENSERVER: "true"
      MM_SERVICESETTINGS_ENABLETESTING: "true"
      MM_SERVICESETTINGS_ENABLEDEVELOPER: "true"
      MM_EXPERIMENTALSETTINGS_ENABLEAUTHENTICATIONTRANSFER: "true"
    ports:
      - "8065:8065"
      - "5432:5432"
    networks:
      - lab-net

networks:
  lab-net:
    driver: bridge
