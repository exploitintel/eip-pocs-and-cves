# docker-compose.yml â€” CVE-2026-28215 Lab Environment
#
# Hoppscotch Unauthenticated Onboarding Bypass
#
# Usage:
#   git clone --branch 2026.1.1 --depth 1 https://github.com/hoppscotch/hoppscotch.git source
#   docker compose up -d
#   docker compose down

services:
  db:
    image: postgres:15-bookworm
    container_name: cve-2026-28215-db
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: testpass
      POSTGRES_DB: hoppscotch
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres -d hoppscotch"]
      interval: 3s
      timeout: 3s
      retries: 15
      start_period: 10s
    networks:
      - lab-net

  vulnerable:
    image: ghcr.io/exploitintel/cve-2026-28215-vulnerable:latest
    container_name: cve-2026-28215-vulnerable
    restart: unless-stopped
    ports:
      - "3170:3170"
    environment:
      DATABASE_URL: "postgresql://postgres:testpass@cve-2026-28215-db:5432/hoppscotch?connect_timeout=300"
      DATA_ENCRYPTION_KEY: "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
      WHITELISTED_ORIGINS: "*"
      PORT: "3170"
      PRODUCTION: "true"
      VITE_BASE_URL: "http://localhost:3000"
      VITE_BACKEND_API_URL: "http://localhost:3170/v1"
      VITE_BACKEND_GQL_URL: "http://localhost:3170/graphql"
      VITE_BACKEND_WS_URL: "ws://localhost:3170/graphql"
      MAILER_SMTP_ENABLE: "false"
      MAILER_USE_CUSTOM_CONFIGS: "false"
      MAILER_ADDRESS_FROM: "noreply@lab.local"
    depends_on:
      db:
        condition: service_healthy
    networks:
      - lab-net

networks:
  lab-net:
    driver: bridge
