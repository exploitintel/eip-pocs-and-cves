# CVE-2025-53192 - Apache Commons OGNL Expression Injection (RCE)

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

## Vulnerability Summary

| Field | Value |
|---|---|
| CVE | CVE-2025-53192 |
| Component | [Apache Commons OGNL](https://github.com/apache/commons-ognl) |
| Type | CWE-146: Improper Neutralization of Expression/Command Delimiters |
| CVSS | 8.8 (High) — `CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H` |
| EPSS | N/A |
| Affected | All versions (project retired — no fix planned) |
| Fix | None — Apache Commons OGNL is retired/dormant |
| Author | Exploit Intelligence Platform |
| Date | 2026-03-01 |

## Vulnerability Details

CVE-2025-53192 is a **critical expression injection vulnerability** in Apache Commons OGNL (Object-Graph Navigation Library) that enables **Remote Code Execution (RCE)**. The library's `DefaultClassResolver` loads any class on the classpath via `ClassLoader.loadClass()` with zero restrictions — no allowlist, no denylist, no package filtering — and `DefaultMemberAccess` only checks Java visibility modifiers, not class-level access controls. Any application that passes user-controlled input to `Ognl.getValue()`, `Ognl.setValue()`, or `Ognl.parseExpression()` is directly exploitable.

The Apache Commons OGNL project is **retired/dormant**. No fix will be released. All versions are vulnerable.

## Root Cause

The vulnerability is **architectural** — OGNL was designed as a powerful object-graph navigation language with full Java reflection capabilities but **no security sandbox**.

1. **Expression Parsing**: `Ognl.parseExpression()` parses an attacker-controlled string into an AST. Static references like `@java.lang.Runtime@getRuntime()` create `ASTStaticMethod` nodes; constructors like `new ProcessBuilder(...)` create `ASTCtor` nodes.

2. **Unrestricted Class Resolution**: `OgnlRuntime.classForName()` delegates to `DefaultClassResolver.classForName()`, which calls `ClassLoader.loadClass(className)` for **any** class name with no check whatsoever.

3. **Unrestricted Method Invocation**: `OgnlRuntime.callStaticMethod()` invokes any public method via reflection. `DefaultMemberAccess.isAccessible()` only verifies `Modifier.isPublic()`.

4. **Result**: Full arbitrary code execution with the privileges of the Java process.

Multiple independent AST code paths are exploitable: static method calls (`ASTStaticMethod`), constructor invocation (`ASTCtor`), instance method chaining (`ASTMethod`), static field access (`ASTStaticField`), and dynamic expression evaluation (`ASTEval`).

## Lab Setup

### Prerequisites

- Docker Engine with Compose plugin
- Python 3 (for running PoC scripts)

### Quick Start

```bash
cd CVE-2025-53192

# Build and start
docker compose build
docker compose up -d

# Run the exploit (port 8531)
python3 poc/poc.py localhost 8531

# Cleanup
docker compose down
```

### Container Details

| Container | Image | Ports | Java |
|-----------|-------|-------|------|
| `cve-2025-53192-vulnerable` | Custom multi-stage build | `8531 → 8080` | OpenJDK 11 (Temurin) |

The lab uses a multi-stage Docker build:
- **Stage 1** (`maven:3.9-eclipse-temurin-11`): Builds `commons-ognl-4.0-SNAPSHOT.jar` from source
- **Stage 2** (`eclipse-temurin:11-jdk`): Copies built JARs, compiles test harness, runs HTTP server

> **Test Harness Disclosure:** The Docker image runs a **custom HTTP test harness** (`OgnlHttpHarness.java`) that wraps the vulnerable `Ognl.getValue()` function in an HTTP endpoint (`POST /eval`). **This harness is NOT part of Apache Commons OGNL** — it was built by EIP to enable standalone network-based PoC testing without `docker exec`. The actual vulnerability exists in the OGNL library's unrestricted `DefaultClassResolver` and `DefaultMemberAccess` (see Root Cause above); the harness simply makes that same evaluation reachable over HTTP for demonstration purposes. This harness is not a realistic attack surface and is **not suitable for Metasploit module development** — MSF modules should target real application endpoints (e.g., Struts, Confluence).

### Management Commands

```bash
# Verify the harness is running
curl http://localhost:8531/health

# Get a shell inside the container
docker exec -it cve-2025-53192-vulnerable bash

# Stop lab
docker compose down
```

## PoC Usage

Four PoC scripts demonstrate the vulnerability through distinct OGNL AST code paths. All scripts are standalone network clients using Python 3 stdlib only (no external dependencies). They connect to the test harness over HTTP.

### Vector 1: Static Method Invocation — `poc/poc.py`

Exploits `@java.lang.Runtime@getRuntime().exec()` via the `ASTStaticMethod` AST node.

```bash
python3 poc/poc.py localhost 8531
```

### Vector 2: ProcessBuilder Constructor Chain — `poc/poc_vector2.py`

Exploits `(new java.lang.ProcessBuilder(...)).start()` via the `ASTCtor` AST node — a different code path from Vector 1.

```bash
python3 poc/poc_vector2.py localhost 8531
```

### Vector 3: Advanced Techniques — `poc/poc_vector3.py`

Demonstrates three advanced exploitation sub-vectors:

| Sub-vector | Technique | AST Path |
|------------|-----------|----------|
| **A** | OGNL variable assignment chain | ASTSequence → ASTAssign → ASTMethod |
| **B** | Nashorn ScriptEngine — RCE via JavaScript | ASTCtor → ASTMethod(eval) |
| **C** | Environment variable exfiltration (no process spawn) | ASTStaticMethod |

```bash
python3 poc/poc_vector3.py localhost 8531
```

### Vector 4: File I/O — `poc/poc_vector4.py`

Demonstrates arbitrary file read/write through Java I/O classes — no shell process needed.

```bash
python3 poc/poc_vector4.py localhost 8531
```

## Verification

### Vulnerable — All Vectors Confirmed

| PoC Script | Vector | AST Code Path | Result |
|------------|--------|---------------|--------|
| `poc.py` | `@Runtime@getRuntime().exec()` | ASTStaticMethod → callStaticMethod() | **RCE confirmed** |
| `poc_vector2.py` | `new ProcessBuilder().start()` | ASTCtor → callConstructor() | **RCE confirmed** |
| `poc_vector3.py` (A) | OGNL variable chain | ASTSequence → ASTAssign → ASTMethod | **RCE confirmed** |
| `poc_vector3.py` (B) | Nashorn ScriptEngine | ASTCtor → ASTMethod → eval() | **RCE confirmed** |
| `poc_vector3.py` (C) | `@System@getenv()` exfil | ASTStaticMethod (no process) | **Info leak confirmed** |
| `poc_vector4.py` (A) | File read (Scanner+File) | ASTCtor(File) → ASTCtor(Scanner) | **File read confirmed** |
| `poc_vector4.py` (B) | File write + verify | ASTStaticMethod(exec) + ASTCtor(Scanner) | **File write confirmed** |

### Patched — Not Applicable

The Apache Commons OGNL project is **retired**. No fix has been released and none is planned. All versions are permanently vulnerable.

## Fix

### Status: **NO FIX — Project Retired**

There is no upstream fix. The Apache Software Foundation has marked Commons OGNL as dormant/retired.

> *"As this project is retired, we do not plan to release a version that fixes this issue. Users are recommended to find an alternative or restrict access to the instance to trusted users."* — Apache Advisory

### Recommended Mitigations

- **Remove the dependency entirely** — migrate to a safer expression language
- **If removal is impossible**: implement a custom `ClassResolver` with a strict allowlist and a custom `MemberAccess` that denies dangerous classes
- **WAF/input validation is NOT sufficient** — the numerous attack vectors make expression-level filtering extremely fragile

## Real-World Relevance

While CVE-2025-53192 targets the library itself, the same OGNL injection primitives have been exploited extensively in downstream frameworks:

| CVE | Product | Impact |
|-----|---------|--------|
| CVE-2018-11776 | Apache Struts 2 | RCE via OGNL injection |
| CVE-2022-26134 | Atlassian Confluence | Pre-auth RCE via OGNL |
| CVE-2021-26084 | Atlassian Confluence | RCE via OGNL injection |

## References

| Resource | URL |
|----------|-----|
| **Apache Advisory** | https://lists.apache.org/thread/2gj8tjl6vz949nnp3yxz3okm9xz2k7sp |
| **OSS-Security** | http://www.openwall.com/lists/oss-security/2025/08/18/4 |
| **GHSA Advisory** | https://github.com/advisories/GHSA-5vgh-76mj-8hcq |
| **NVD Entry** | https://nvd.nist.gov/vuln/detail/CVE-2025-53192 |
| **Source Repository** | https://github.com/apache/commons-ognl |

## Disclaimer

This proof-of-concept is provided for **authorized security testing and educational purposes only**. It is intended to help defenders understand, detect, and remediate CVE-2025-53192 in their environments.

**Do not** use this tool against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions and may violate laws including the Computer Fraud and Abuse Act (CFAA), the Computer Misuse Act, and equivalent legislation worldwide.

The authors assume no liability for misuse of this material. This project follows responsible disclosure practices.
