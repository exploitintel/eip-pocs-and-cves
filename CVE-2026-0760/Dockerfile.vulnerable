# CVE-2026-0760 â€” MetaGPT v0.8.1 Deserialization RCE
# Exploit Intelligence Platform | https://exploit-intel.com | @exploit_intel
FROM python:3.9-slim-bookworm

# Install system build dependencies needed by compiled Python packages
RUN apt-get update && apt-get install -y --no-install-recommends \
    gcc \
    g++ \
    make \
    git \
    libgomp1 \
    libffi-dev \
    && rm -rf /var/lib/apt/lists/*

# Clone MetaGPT at vulnerable version v0.8.1
RUN git clone --depth 1 --branch v0.8.1 https://github.com/geekan/MetaGPT.git /opt/metagpt
WORKDIR /opt/metagpt

# Install a stripped-down requirements file for just the serialize module chain
# The full requirements.txt has many heavy/optional deps we don't need
COPY requirements-minimal.txt /opt/metagpt/requirements-minimal.txt
RUN pip install --no-cache-dir -r requirements-minimal.txt && \
    pip install --no-cache-dir --no-deps -e .

# Copy the verification and demo scripts
COPY verify.py /opt/verify.py
COPY vuln_server.py /opt/vuln_server.py

# Expose the demo HTTP endpoint
EXPOSE 8080

# Keep container running with the vulnerable demo server
CMD ["python3", "/opt/vuln_server.py"]
