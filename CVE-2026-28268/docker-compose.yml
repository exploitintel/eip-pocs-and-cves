# docker-compose.yml â€” CVE-2026-28268 Lab Environment
#
# Vikunja v2.0.0 with password reset token reuse vulnerability.
# Single container (SQLite embedded, no external services needed).
#
# Usage:
#   docker compose up -d
#   docker compose down

services:
  vulnerable:
    build:
      context: .
      dockerfile: Dockerfile.vulnerable
    image: cve-2026-28268-vulnerable:latest
    container_name: cve-2026-28268-vulnerable
    environment:
      - VIKUNJA_DATABASE_TYPE=sqlite
      - VIKUNJA_DATABASE_PATH=/data/vikunja.db
      - VIKUNJA_SERVICE_INTERFACE=:3456
      - VIKUNJA_MAILER_ENABLED=false
      - VIKUNJA_SERVICE_ENABLEREGISTRATION=true
      - VIKUNJA_AUTH_LOCAL_ENABLED=true
      - VIKUNJA_SERVICE_JWTSECRET=lab-jwt-secret-2026
      - VIKUNJA_LOG_LEVEL=DEBUG
      - VIKUNJA_SERVICE_ROOTPATH=/app/vikunja/
      - VIKUNJA_RATELIMIT_ENABLED=false
      - VIKUNJA_CORS_ENABLE=false
      - VIKUNJA_SERVICE_PUBLICURL=http://localhost:3456
    volumes:
      - ./data:/data
    ports:
      - "3456:3456"
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:3456/api/v1/info"]
      interval: 5s
      timeout: 3s
      retries: 10
