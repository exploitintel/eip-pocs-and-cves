# docker-compose.yml — CVE-2026-0765 Lab Environment
#
# Open WebUI v0.6.32 pip Command Injection (CWE-78) — vulnerable target
#
# Usage:
#   docker compose up -d
#   docker compose down

services:
  vulnerable:
    image: ghcr.io/open-webui/open-webui:v0.6.32
    container_name: cve-2026-0765-vulnerable
    ports:
      - "8080:8080"
    environment:
      - WEBUI_SECRET_KEY=poc-secret-key-cve-2026-0765
      - USE_SLIM_DOCKER=true
      - USE_OLLAMA_DOCKER=false
      - WEBUI_AUTH=true
      - ENABLE_SIGNUP=true
      - ENV=prod
      - PORT=8080
      - HOST=0.0.0.0
      - GIT_PYTHON_REFRESH=quiet
    extra_hosts:
      - "host.docker.internal:host-gateway"
    healthcheck:
      test: ["CMD", "curl", "--silent", "--fail", "http://localhost:8080/health"]
      interval: 10s
      timeout: 5s
      retries: 30
      start_period: 60s
    networks:
      - lab-net

networks:
  lab-net:
    driver: bridge
