# CVE-2026-2635 Lab - MLflow v3.10.0 (FastAPI Fix Applied)
# FastAPI auth bypass fixed (PR #20920), but default credentials still present
FROM python:3.10-slim-bullseye

# Install MLflow v3.10.0 - includes the FastAPI auth fix (PR #20920)
# But STILL has default credentials in basic_auth.ini
RUN pip install --no-cache-dir "mlflow[auth]==3.10.0"

# Set required environment variables
ENV MLFLOW_FLASK_SERVER_SECRET_KEY=cve-2026-2635-lab-secret-key-v310

# Create a working directory for MLflow data
WORKDIR /mlflow

EXPOSE 5000

CMD ["mlflow", "server", "--app-name", "basic-auth", "--host", "0.0.0.0", "--port", "5000"]
