# Lab Build Report: CVE-2026-2635

## CVE Summary

| Field | Value |
|---|---|
| **CVE ID** | CVE-2026-2635 |
| **Title** | MLflow Authentication Bypass via Default Credentials |
| **Software** | MLflow v3.9.0 |
| **CVSS** | 9.8 Critical |

---

## Lab Architecture

### Overview

Single-container lab running MLflow v3.9.0 with HTTP Basic Authentication enabled (`--app-name basic-auth`). The vulnerability is in the default installation — no additional services (database, cache, etc.) are needed since MLflow uses an embedded SQLite database.

### Container Topology

```
┌─────────────────────────────────────────┐
│  cve-2026-2635-vulnerable               │
│  MLflow v3.9.0 + basic-auth             │
│  Port: 5000                             │
│  Default creds: admin / password1234    │
│  SQLite DB: /mlflow/basic_auth.db       │
│                                         │
│  Networks: lab-net                      │
└─────────────────────────────────────────┘
```

---

## Container Details

### vulnerable (cve-2026-2635-vulnerable)

| Field | Value |
|---|---|
| **Container Name** | `cve-2026-2635-vulnerable` |
| **Image** | `lab-vulnerable` (built from `Dockerfile.vulnerable`) |
| **Base Image** | `python:3.10-slim-bullseye` |
| **Software** | MLflow 3.9.0 with `[auth]` extra |
| **Exposed Port** | 5000 (MLflow tracking server) |
| **Networks** | `lab-net` |
| **Environment** | `MLFLOW_FLASK_SERVER_SECRET_KEY=cve-2026-2635-lab-secret-key` |
| **Healthcheck** | Python urllib check on `http://localhost:5000/health` |
| **Build Status** | ✅ SUCCESS |

### Default Credentials (Vulnerability)

| Username | Password | Role |
|---|---|---|
| `admin` | `password1234` | Administrator (full access, bypasses all authorization) |

---

## Files Created

| File | Description |
|---|---|
| `Dockerfile.vulnerable` | Dockerfile for vulnerable MLflow v3.9.0 with basic-auth |
| `docker-compose.yml` | Docker Compose configuration |

---

## Start/Stop Commands

```bash
# Start the lab
docker compose up -d

# Check status
docker compose ps

# View logs
docker compose logs vulnerable

# Stop the lab
docker compose down

# Full reset (remove volumes)
docker compose down -v
```

---

## Accessing the Vulnerable Container

From the host, use localhost with the mapped port:

```bash
# Access MLflow API (authenticated with default credentials)
curl -u admin:password1234 "http://localhost:5000/api/2.0/mlflow/users/get?username=admin"
```

---

## Verification Results

### Build Verification

| Step | Result |
|---|---|
| Docker image build | ✅ Success — `lab-vulnerable` image built from `python:3.10-slim-bullseye` |
| Container start | ✅ Success — Container started and healthy |
| MLflow version | ✅ Confirmed v3.9.0 (`import mlflow; mlflow.__version__`) |
| Health endpoint | ✅ `GET /health` returns `OK` |

### Vulnerability Verification

| Test | Expected | Actual | Status |
|---|---|---|---|
| Unauthenticated request to `/api/2.0/mlflow/experiments/search` | HTTP 401 | HTTP 401 | ✅ PASS |
| Auth with `admin:password1234` to `/api/2.0/mlflow/users/get?username=admin` | HTTP 200, `is_admin: true` | HTTP 200, `is_admin: true` | ✅ PASS |
| Create user with admin credentials | HTTP 200, user created | HTTP 200, user `testuser` created (id=2) | ✅ PASS |
| Auth with wrong password `admin:wrongpassword` | HTTP 401 | HTTP 401 | ✅ PASS |

### Verified Admin Response

```json
{
  "user": {
    "experiment_permissions": [],
    "id": 1,
    "is_admin": true,
    "registered_model_permissions": [],
    "scorer_permissions": [],
    "username": "admin"
  }
}
```

---

## PoC Agent Guidance

### Target Information

| Field | Value |
|---|---|
| **Container Name** | `cve-2026-2635-vulnerable` |
| **Container IP** | `localhost` (ports mapped to host) |
| **Port** | 5000 |
| **Protocol** | HTTP |
| **Auth Method** | HTTP Basic Authentication |
| **Default Username** | `admin` |
| **Default Password** | `password1234` |

### Key API Endpoints

| Endpoint | Method | Description |
|---|---|---|
| `/health` | GET | Health check (no auth required) |
| `/api/2.0/mlflow/users/get?username=admin` | GET | Get admin user details |
| `/api/2.0/mlflow/experiments/search` | POST | Search experiments (requires `max_results` param) |
| `/api/2.0/mlflow/users/create` | POST | Create new user (admin only) |
| `/api/2.0/mlflow/users/update-admin` | PATCH | Grant/revoke admin privileges |

### Exploitation Flow

1. Verify auth is enabled: unauthenticated request → 401
2. Authenticate with default credentials: `admin:password1234` → 200
3. Confirm admin access: query user details, verify `is_admin: true`
4. Demonstrate impact: create backdoor user, list experiments, etc.

---

## Known Issues

- **None.** The lab is straightforward — MLflow installs cleanly from PyPI and the vulnerability exists in the default configuration.
- The `experiments/search` endpoint requires a `max_results` parameter (POST body) for full results; without it, a parameter validation error is returned. This is normal MLflow behavior, not a lab issue. The PoC should use POST with proper JSON body for experiment listing.
