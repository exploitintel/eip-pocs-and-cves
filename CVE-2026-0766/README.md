# CVE-2026-0766: Open WebUI Remote Code Execution via `exec()` Code Injection

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

| Field | Value |
|-------|-------|
| **CVE** | CVE-2026-0766 |
| **Target** | Open WebUI <= v0.8.5 |
| **Class** | CWE-94 — Code Injection |
| **CVSS** | 8.8 (HIGH) `AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H` |
| **EPSS** | 0.6% (70.3rd percentile) |
| **Vendor** | open-webui |
| **Patch** | None (architectural — no fix as of v0.8.5) |
| **Advisory** | [ZDI-26-032](https://www.zerodayinitiative.com/advisories/ZDI-26-032/) |

## Overview

Open WebUI versions through at least v0.8.5 contain a critical remote code execution vulnerability in the tools and functions plugin system. The `load_tool_module_by_id()` and `load_function_module_by_id()` functions in `backend/open_webui/utils/plugin.py` execute user-supplied Python code via `exec(content, module.__dict__)` without any validation, sanitization, or sandboxing. An authenticated user with tool creation privileges (admin by default, or any user granted `workspace.tools` permission) can inject arbitrary Python code that runs on the server as root (UID 0 in the default Docker deployment).

On a fresh Open WebUI instance—where signup is enabled by default—the first user to register automatically becomes admin, making this exploitable with zero prior access.

## Affected Versions

- **All versions through v0.8.5** (latest at time of analysis)
- **No patch exists** — the `exec()` call on user-supplied content is present in every released version
- The ZDI advisory (ZDI-26-032) recommends restricting network access as the sole mitigation

## CVSS Score

| Metric | Value |
|--------|-------|
| **Score** | **8.8 (HIGH)** |
| **Vector** | `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H` |
| **EPSS** | 0.6% (70.3rd percentile) |
| **CWE** | CWE-94: Improper Control of Generation of Code (Code Injection) |

## Root Cause

The vulnerability is a direct **arbitrary Python code execution** via Python's `exec()` builtin. The function `load_tool_module_by_id()` in `backend/open_webui/utils/plugin.py` (line 101 in v0.6.32) takes the user-supplied `content` field from a tool creation or update request and passes it directly to `exec(content, module.__dict__)`. There is zero validation, sanitization, sandboxing, or AST inspection of the content before execution.

While the application expects the `content` field to define a `Tools` class, any arbitrary Python code placed in the content executes immediately during the `exec()` call—before any class validation occurs. An identical vulnerability exists in `load_function_module_by_id()` at line 145, which processes the functions API endpoints. Additionally, a secondary command injection vector exists in `install_frontmatter_requirements()` (lines 267–283), where user-controlled requirements are passed directly to a `pip install` subprocess.

This is not a complex injection bypass. The application is architecturally designed to execute user-provided Python code as "tools" and "functions." The vulnerability is that this capability is exposed to authenticated users without any code safety controls whatsoever.

### Vulnerable Code Paths

```
# Vector 1: Tool Creation (Primary — lowest privilege requirement)
POST /api/v1/tools/create
  → routers/tools.py — create_new_tools()
    → plugin.py — load_tool_module_by_id(id, content=form_data.content)
      → exec(content, module.__dict__)  ← RCE

# Vector 2: Function Creation (Admin only)
POST /api/v1/functions/create
  → routers/functions.py — create_new_function()
    → plugin.py — load_function_module_by_id(id, content=form_data.content)
      → exec(content, module.__dict__)  ← RCE

# Vector 3: Tool Update (Owner/write/admin)
POST /api/v1/tools/id/{id}/update
  → routers/tools.py — update_tools_by_id()
    → plugin.py — load_tool_module_by_id(id, content=form_data.content)
      → exec(content, module.__dict__)  ← RCE
```

## Lab Setup

### Prerequisites

- Docker with the Compose plugin installed
- Network access to pull from `ghcr.io`

### Starting the Lab

```bash
docker compose up -d
```

> **Note:** The container uses a pre-built image (`ghcr.io/open-webui/open-webui:v0.6.32`), so no build step is needed. The `up -d` command will pull the image and start the container.

### Container Details

| Container | Image | Role | Internal Port |
|-----------|-------|------|---------------|
| `cve-2026-0766-vulnerable` | `ghcr.io/open-webui/open-webui:v0.6.32` | Vulnerable Open WebUI instance | 8080 |

### Health Check

The container takes approximately 30 seconds to become healthy. Wait for the health check to pass:

```bash
# Wait for container to be healthy
docker inspect --format='{{.State.Health.Status}}' cve-2026-0766-vulnerable

# Or verify directly
curl http://localhost:8080/health
# Expected: {"status":true}
```

### Stopping & Resetting

```bash
# Stop lab
docker compose down

# Full reset (removes database — re-registration required)
docker compose down -v
docker compose up -d
```

## PoC Usage

Three self-contained PoC scripts are provided in `poc/`, each demonstrating a different attack vector. All scripts use only Python 3 standard library (no external dependencies).

### Vector 1: Tool Creation (Primary)

The primary exploitation path. Creates a malicious tool whose `content` field contains arbitrary Python code that executes via `exec()`.

```bash
python3 poc/poc.py <target_host> [port]
```

**Example:**
```bash
python3 poc/poc.py localhost 8080
```

**Expected Output:**
```
======================================================================
  CVE-2026-0766: Open WebUI Remote Code Execution
  Vector: Tool Creation (POST /api/v1/tools/create)
  Target: http://localhost:8080
======================================================================

[*] Checking target health at http://localhost:8080/health ...
[+] Target is up and healthy
[+] Open WebUI version: 0.6.32

[*] Attempting authentication...
[+] Signed in successfully as admin (existing account)

[*] Crafting malicious tool payload...
[*] Sending exploit payload to /api/v1/tools/create ...
[+] Tool created successfully (HTTP 200)
[+] The exec() call has executed our injected Python code

[*] Verifying code execution...

======================================================================
  EXPLOITATION SUCCESSFUL — Remote Code Execution Confirmed
======================================================================

  Sentinel file contents:
    CVE-2026-0766-RCE-CONFIRMED
    Output: uid=0(root) gid=0(root) groups=0(root)

[+] CVE-2026-0766 CONFIRMED: Arbitrary code execution via tool creation
```

### Vector 2: Function Creation

Targets the parallel `load_function_module_by_id()` code path via the functions API. Admin-only.

```bash
python3 poc/poc_vector2_functions.py <target_host> [port]
```

**Expected Output:** Confirms RCE through a separate code path (`plugin.py` line 145) with system information disclosure.

### Vector 3: Tool Update

Two-step attack: creates a benign tool, then updates it with malicious content. Demonstrates that existing tools can be weaponized post-creation and that malicious code persists in the database.

```bash
python3 poc/poc_vector3_tool_update.py <target_host> [port]
```

**Expected Output:** Confirms RCE via the update endpoint, shows directory listing and SQLite database access.

### Authentication

All PoC scripts handle authentication automatically:
- **Fresh instance**: Signs up as the first user (becomes admin automatically)
- **Existing instance**: Signs in with lab credentials (`admin@cveforge.lab` / `LabPass123`)

## Verification

### Vulnerable Instance (v0.6.32 — All Vectors Confirmed)

| Vector | Endpoint | Result |
|--------|----------|--------|
| Tool Create | `POST /api/v1/tools/create` | ✅ RCE as root (UID 0) |
| Function Create | `POST /api/v1/functions/create` | ✅ RCE as root (UID 0) |
| Tool Update | `POST /api/v1/tools/id/{id}/update` | ✅ RCE as root (UID 0) |

**Evidence of exploitation (from sentinel file written inside the container):**
```
uid=0(root) gid=0(root) groups=0(root)
```

### Patched Instance

**No patched version exists.** The `exec(content, module.__dict__)` call persists through all released versions up to v0.8.5 (latest as of 2026-03-01). The ZDI advisory recommends network access restriction as the only mitigation.

### Impact Demonstrated

1. **Arbitrary OS command execution** as root (UID 0)
2. **File system access**: Read/write to any path in the container
3. **Database access**: SQLite DB at `/app/backend/data/webui.db` containing all user credentials, chat histories, and API keys
4. **System information disclosure**: Kernel version, OS details, hostname
5. **Persistence**: Malicious code is stored in the database and re-executed on tool load, cache miss, or even tool listing

## Fix

### Status: No Fix Available

As of v0.8.5 (the latest release at the time of analysis), **no patch has been released**. The `exec(content, module.__dict__)` call is present in both `load_tool_module_by_id()` and `load_function_module_by_id()` in every released version.

### Recommended Mitigations (from ZDI-26-032)

- **Restrict network access** to Open WebUI instances — do not expose to untrusted networks
- **Disable signup** (`ENABLE_SIGNUP=False`) on production instances to prevent unauthorized admin creation
- **Restrict tool permissions** — do not grant `workspace.tools` permission to untrusted users
- **Network segmentation** — isolate Open WebUI containers from sensitive internal resources

### What a Proper Fix Would Require

The vulnerability is architectural. A proper remediation would need one or more of:
- **Sandboxed Python execution** (e.g., RestrictedPython, PyPy sandbox, containerized code execution)
- **AST-based validation** restricting allowed imports, function calls, and operations
- **A fundamentally different plugin architecture** (e.g., WASM-based plugins, declarative JSON-defined tools)

## References

| Reference | URL |
|-----------|-----|
| **ZDI Advisory** | https://www.zerodayinitiative.com/advisories/ZDI-26-032/ |
| **GHSA** | https://github.com/advisories/GHSA-cggw-334c-f4mj |
| **NVD** | https://nvd.nist.gov/vuln/detail/CVE-2026-0766 |
| **Source Repository** | https://github.com/open-webui/open-webui |
| **Vulnerable File** | `backend/open_webui/utils/plugin.py` |
| **Vulnerable Endpoints** | `backend/open_webui/routers/tools.py`, `backend/open_webui/routers/functions.py` |

## Timeline

| Date | Event |
|------|-------|
| 2025-10-09 | Vulnerability reported to vendor via ZDI |
| 2026-01-09 | ZDI advisory published (ZDI-26-032 / ZDI-CAN-28257) |
| 2026-01-23 | CVE-2026-0766 published |
| 2026-03-01 | No patch released as of analysis date |

## Disclaimer

These proof-of-concept materials are provided for **authorized security testing and educational purposes only**. They exist to help defenders understand, detect, and remediate vulnerabilities in their environments.

**Do not** use these tools against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions.

The authors assume no liability for misuse. This project follows responsible disclosure practices.
