# CVE-2026-0766 â€” Open WebUI exec() Code Injection to RCE
#
# Usage:
#   docker compose up -d
#   python3 poc/poc.py localhost 8080
#   docker compose down

services:
  vulnerable:
    image: ghcr.io/open-webui/open-webui:v0.6.32
    container_name: cve-2026-0766-vulnerable
    ports:
      - "18082:8080"
    environment:
      - WEBUI_SECRET_KEY=cveforge-lab-secret-key
      - ENABLE_SIGNUP=True
      # Disable telemetry and update checks for isolated lab
      - SCARF_NO_ANALYTICS=true
      - DO_NOT_TRACK=true
      - ANONYMIZED_TELEMETRY=False
      # No LLM backend needed - vulnerability is in the tools API
      - OLLAMA_BASE_URL=
      - OPENAI_API_BASE_URL=
    volumes:
      - open-webui-data:/app/backend/data
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:8080/health"]
      interval: 10s
      timeout: 5s
      retries: 30
      start_period: 30s
    networks:
      - lab-net

networks:
  lab-net:
    driver: bridge

volumes:
  open-webui-data:
