# CVE-2025-58159 Lab

> WeGIA — Unrestricted File Upload to RCE

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc/poc.py` | XLSX/PHP polyglot upload → webshell → RCE as www-data |

## Setup

```bash
cd CVE-2025-58159
docker compose up -d
```

Wait ~15s for health checks. Verify: `docker compose ps`

**Ports:** 8083 (vulnerable WeGIA 3.4.10), 8084 (patched WeGIA 3.4.11)
**Credentials:** `admin` / `wegia`

## Run

```bash
# Exploit vulnerable target
python3 poc/poc.py localhost 8083 id

# Verify patched target blocks it (expected: HTTP 404)
python3 poc/poc.py localhost 8084 id
```

## Teardown

```bash
docker compose down -v
```
