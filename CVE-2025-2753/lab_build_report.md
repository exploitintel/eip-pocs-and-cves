# Lab Build Report: CVE-2025-2753

## Lab Architecture

**Type:** Single container (file-parsing vulnerability — no network services required)

This is a memory corruption vulnerability in the assimp C++ library triggered by opening a malformed LWS file. The lab provides the compiled assimp CLI tool in two variants (with and without AddressSanitizer) and the crash PoC file.

### Container: `cve-2025-2753-vulnerable`

| Field | Value |
|---|---|
| **Image** | `cve-2025-2753-vulnerable:latest` |
| **Base Image** | `ubuntu:22.04` |
| **Container Name** | `cve-2025-2753-vulnerable` |
| **Networks** | `lab-net` |
| **Build Status** | ✅ SUCCESS |
| **Software Version** | assimp v5.4.3 (commit c35200e3) |

### Builds Inside Container

| Build | Path | Purpose |
|---|---|---|
| **ASan Debug** | `/opt/assimp/build-asan/bin/assimpd` | AddressSanitizer-instrumented build for clear crash detection with stack trace |
| **Standard Debug** | `/opt/assimp/build-release/bin/assimpd` | Non-ASan debug build for standard SIGSEGV crash (exit code 139) |

### Convenience Symlinks

| Symlink | Target |
|---|---|
| `/usr/local/bin/assimp-asan` | `/opt/assimp/build-asan/bin/assimpd` |
| `/usr/local/bin/assimp-release` | `/opt/assimp/build-release/bin/assimpd` |

### PoC File

| File | Path | Size |
|---|---|---|
| Crash LWS file | `/opt/poc/crash.lws` | 661 bytes |

## Container Details

### Dockerfile: `Dockerfile.vulnerable`

- **Base**: `ubuntu:22.04`
- **Build deps**: `ninja-build`, `git`, `cmake`, `build-essential`, `zlib1g-dev`
- **Source**: Cloned from GitHub at v5.4.3
- **ASan build flags**: `-fsanitize=address -fno-omit-frame-pointer` on CXX, C, EXE_LINKER, and SHARED_LINKER
- **CMD**: `sleep infinity` (keeps container running for `docker exec` access)

### Docker Compose

- Single service: `vulnerable`
- Network: `lab-net`
- Build context: `.`

## Start/Stop Commands

```bash
# Start the lab
docker compose up -d

# Check status
docker compose ps

# View logs
docker compose logs

# Stop the lab
docker compose down
```

## Triggering the Vulnerability

### Method 1: ASan build (recommended — detailed crash report)
```bash
docker exec cve-2025-2753-vulnerable bash -c \
  'LD_LIBRARY_PATH=/opt/assimp/build-asan/bin assimp-asan info /opt/poc/crash.lws'
```

**Expected output**: ASan SEGV report with stack trace showing:
```
ERROR: AddressSanitizer: SEGV on unknown address 0x17d7d7e7d7d7d7d7
  #0 aiString::operator=(aiString const&)
  #1 aiLight::operator=(aiLight const&)
  #2 Assimp::SceneCombiner::Copy(aiLight**, aiLight const*)
  #3 CopyPtrArray<aiLight>(aiLight**&, ...)
  #4 Assimp::SceneCombiner::CopyScene(aiScene**, aiScene const*, bool)
  #5 Assimp::SceneCombiner::CopySceneFlat(aiScene**, aiScene const*)
  #6 Assimp::SceneCombiner::MergeScenes(...)
  #7 Assimp::LWSImporter::InternReadFile(...)
```

### Method 2: Release build (standard SIGSEGV crash)
```bash
docker exec cve-2025-2753-vulnerable bash -c \
  'LD_LIBRARY_PATH=/opt/assimp/build-release/bin assimp-release info /opt/poc/crash.lws; echo "EXIT=$?"'
```

**Expected output**: `Segmentation fault` with exit code 139.

## Verification Evidence

### ASan Build — CONFIRMED ✅
```
AddressSanitizer:DEADLYSIGNAL
=================================================================
==32==ERROR: AddressSanitizer: SEGV on unknown address 0x17d7d7e7d7d7d7d7 (pc 0xffff91c088e0 ...)
==32==The signal is caused by a READ memory access.
    #0 aiString::operator=(aiString const&) /opt/assimp/include/assimp/types.h:322
    #1 aiLight::operator=(aiLight const&) /opt/assimp/include/assimp/light.h:115
    #2 Assimp::SceneCombiner::Copy(aiLight**, aiLight const*) /opt/assimp/code/Common/SceneCombiner.cpp:1284
    #3 CopyPtrArray<aiLight>(aiLight**&, aiLight const* const*, unsigned int)
    #4 Assimp::SceneCombiner::CopyScene(aiScene**, aiScene const*, bool)
    #5 Assimp::SceneCombiner::CopySceneFlat(aiScene**, aiScene const*)
    #6 Assimp::SceneCombiner::MergeScenes(...)
    #7 Assimp::LWSImporter::InternReadFile(...) /opt/assimp/code/AssetLib/LWS/LWSLoader.cpp:902
SUMMARY: AddressSanitizer: SEGV /opt/assimp/include/assimp/types.h:322 in aiString::operator=(aiString const&)
EXIT_CODE=1
```

### Release Build — CONFIRMED ✅
```
Segmentation fault
EXIT_CODE=139
```

### Version — CONFIRMED ✅
```
Version 5.4 -debug -shared -st (GIT commit c35200e3)
```

## Known Issues

- None. The lab builds cleanly and the vulnerability triggers reliably with the provided crash file.
- The binary is named `assimpd` (debug suffix) rather than `assimp` — symlinks handle this.
- `LD_LIBRARY_PATH` must be set when invoking via symlinks to locate the correct `libassimpd.so`.

## Lab Files

| File | Path |
|---|---|
| Dockerfile (vulnerable) | `Dockerfile.vulnerable` |
| Docker Compose | `docker-compose.yml` |
| Crash PoC | `poc/crash.lws` |
