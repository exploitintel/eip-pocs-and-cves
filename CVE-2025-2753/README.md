# CVE-2025-2753 — Assimp LWS Importer Uninitialized Pointer Array (Out-of-Bounds Read)

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

## Vulnerability Summary

| Field | Value |
|---|---|
| CVE | CVE-2025-2753 |
| Component | [Open Asset Import Library (assimp)](https://github.com/assimp/assimp) |
| Type | CWE-457: Use of Uninitialized Variable / CWE-125: Out-of-bounds Read |
| CVSS | 6.3 (MEDIUM) — `CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L` |
| EPSS | 0.2% (37.9th percentile) |
| Affected | v5.4.3 and all versions through v6.0.4 |
| Fix | **UNFIXED** — no patch available as of March 2026 (0-day) |
| Author | Exploit Intelligence Platform |
| Date | 2026-03-01 |

## Vulnerability Details

The LightWave Scene (LWS) file importer in assimp allocates pointer arrays for lights and cameras using `new Type*[count]` **without value-initialization**. When a malformed LWS file causes the loader to leave array slots unfilled (via circular parent references or garbled parent IDs), uninitialized heap pointers are subsequently dereferenced during scene merging, resulting in a segmentation fault (denial of service) and potential heap information disclosure.

The root cause is a **two-phase count-vs-fill mismatch**: the parser counts `AddLight`/`AddCamera` keywords and allocates arrays, but `BuildGraph()` only fills slots for nodes reachable from the root. Unreachable nodes leave slots containing heap garbage (`0xbebebebebebebebe` under ASan).

```cpp
// LWSLoader.cpp — BUG: missing trailing () for zero-initialization
master->mCameras = new aiCamera *[master->mNumCameras = num_camera];
master->mLights = new aiLight *[master->mNumLights = num_light];
```

### Attack Chain

```
1. Attacker crafts malformed LWS file with circular ParentObject references
2. Victim opens file via any assimp-based application (editor, converter, viewer)
3. LWS parser counts AddLight/AddCamera → allocates uninitialized pointer arrays
4. BuildGraph traverses scene graph → misses unreachable light/camera nodes
5. MergeScenes → CopyPtrArray dereferences garbage pointer → SEGV (crash)
```

### Fix

**UNFIXED** — the vulnerability remains present in all released versions through v6.0.4 (January 2026). The GitHub issue (#6014) was reopened on August 28, 2025.

The recommended fix (value-initialization + CopyPtrArray null-check) is **incomplete** — see `bypass_analysis.md` for 2 confirmed bypass paths that still crash via NULL pointer dereference.

## Lab Setup

### Architecture

```
┌──────────────────────────────┐
│  cve-2025-2753-vulnerable    │  assimp v5.4.3 (ASan + release builds)
│  No network services         │  Trigger via: docker exec ... assimp-asan info /opt/poc/crash.lws
└──────────────────────────────┘

┌──────────────────────────────┐
│  cve-2025-2753-patched       │  assimp v5.4.3 + recommended fix (incomplete)
│  No network services         │  Used for bypass demonstration
└──────────────────────────────┘
```

### Quick Start

```bash
cd CVE-2025-2753

# Build and start (both vulnerable and patched containers)
docker compose build
docker compose up -d

# Run the exploit (Vector 1 — light array crash)
python3 poc/poc.py

# Run all vectors
python3 poc/poc.py                    # Vector 1: Light array (original crash file)
python3 poc/poc_vector2.py            # Vector 2: Camera array (hand-crafted LWS)
python3 poc/poc_vector3.py            # Vector 3: ReadFileFromMemory C API

# Bypass PoC (patched container)
python3 poc/bypass_poc.py

# Cleanup
docker compose down
```

### Container Details

| Container | Role | Base | Description |
|---|---|---|---|
| `cve-2025-2753-vulnerable` | Vulnerable target | `ubuntu:22.04` | assimp v5.4.3 with ASan and release builds |
| `cve-2025-2753-patched` | Patched (incomplete) | `ubuntu:22.04` | assimp v5.4.3 + value-init fix (bypassed) |

Each container includes:

| Binary | Path | Purpose |
|---|---|---|
| `assimp-asan` | `/usr/local/bin/assimp-asan` | ASan-instrumented — detailed crash reports with stack traces |
| `assimp-release` | `/usr/local/bin/assimp-release` | Standard debug build — SIGSEGV crash (exit code 139) |

The crash file is pre-loaded at `/opt/poc/crash.lws` inside each container.

## PoC Usage

Four PoC scripts demonstrate the vulnerability through different attack vectors. All are standalone Python 3 tools with **no external dependencies** (stdlib only).

### Vector 1: Original Crash File (Light Array) — `poc/poc.py`

Triggers the vulnerability via the `mLights` array using the original 661-byte crash file from GitHub issue #6014.

```bash
python3 poc/poc.py [container_name]

# Or directly via Docker:
docker exec cve-2025-2753-vulnerable bash -c \
  'LD_LIBRARY_PATH=/opt/assimp/build-asan/bin assimp-asan info /opt/poc/crash.lws'
```

### Vector 2: Hand-Crafted Camera Variant — `poc/poc_vector2.py`

Targets the `mCameras` array using a clean 151-byte hand-crafted LWS file with circular parent references.

```bash
python3 poc/poc_vector2.py [container_name]
```

### Vector 3: ReadFileFromMemory C API — `poc/poc_vector3.py`

Demonstrates the vulnerability through assimp's C API `aiImportFileFromMemory()`, proving the attack surface extends to any application processing user-supplied 3D data from memory buffers.

```bash
python3 poc/poc_vector3.py [container_name]
```

### Vector 4: Bypass PoC — `poc/bypass_poc.py`

Tests the recommended fix on the patched container and demonstrates 2 bypass paths that still crash.

```bash
python3 poc/bypass_poc.py [patched_container] [vulnerable_container]
```

## Verification

### ASan Build — Vulnerable (v5.4.3)

```
AddressSanitizer:DEADLYSIGNAL
=================================================================
==74==ERROR: AddressSanitizer: SEGV on unknown address 0x17d7d7e7d7d7d7d7
==74==The signal is caused by a READ memory access.
    #0 aiString::operator=(aiString const&)
    #1 aiLight::operator=(aiLight const&)
    #2 Assimp::SceneCombiner::Copy(aiLight**, aiLight const*)
    #3 CopyPtrArray<aiLight>(aiLight**&, aiLight const* const*, unsigned int)
    #4 Assimp::SceneCombiner::CopyScene(aiScene**, aiScene const*, bool)
    #7 Assimp::LWSImporter::InternReadFile(...)
```

### Results Summary

| # | Vector | Target | ASan | Release |
|---|--------|--------|------|---------|
| 1 | Original crash file (lights) | `CopyPtrArray<aiLight>` | SEGV confirmed | SIGSEGV (139) |
| 2 | Hand-crafted (cameras) | `ProcessCamera(aiCamera*)` | SEGV confirmed | SIGSEGV (139) |
| 3 | ReadFileFromMemory API | `aiImportFileFromMemory()` | SIGSEGV (signal 11) | Silent (heap leak) |
| 4 | Bypass (patched) | `ProcessCamera` / `ValidateDSProcess` | SEGV at NULL | SIGSEGV (139) |

## Files

| File | Description |
|---|---|
| `poc/poc.py` | Vector 1: Light array crash via original crash file |
| `poc/poc_vector2.py` | Vector 2: Camera array crash via hand-crafted LWS |
| `poc/poc_vector3.py` | Vector 3: ReadFileFromMemory C API trigger |
| `poc/bypass_poc.py` | Bypass PoC demonstrating incomplete fix |
| `poc/crash.lws` | 661-byte malformed LWS crash file from issue #6014 |
| `Dockerfile.vulnerable` | Ubuntu 22.04 + assimp v5.4.3 (ASan + release builds) |
| `Dockerfile.patched` | Same + recommended fix applied (incomplete) |
| `docker-compose.yml` | Lab orchestration (vulnerable + patched containers) |
| `fix_cve_2025_2753.patch` | Reference patch file |
| `intel_brief.md` | CVE intelligence brief |
| `vulnerability_analysis.md` | Root cause analysis |
| `bypass_analysis.md` | Fix bypass analysis (2 confirmed bypasses) |
| `lab_build_report.md` | Container build report |
| `poc_verification_report.md` | PoC test results across all vectors |

## References

- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2025-2753)
- [Bug Report / PoC](https://github.com/assimp/assimp/issues/6014)
- [GHSA Advisory](https://github.com/advisories/GHSA-6gmq-j827-jv97)
- [Source Repository](https://github.com/assimp/assimp)
- [Related PR (partial)](https://github.com/assimp/assimp/pull/6029)

## Timeline

| Date | Event |
|---|---|
| 2025-03-25 | CVE-2025-2753 published |
| 2025-03-25 | GitHub issue #6014 filed with crash PoC |
| 2025-08-28 | Issue #6014 reopened (fix incomplete/absent) |
| 2026-01-xx | assimp v6.0.4 released — still unfixed |
| 2026-03-01 | Lab verification and bypass analysis |

## Disclaimer

This proof-of-concept is provided for **authorized security testing and educational purposes only**. It is intended to help defenders understand, detect, and remediate CVE-2025-2753 in their environments.

**Do not** use this tool against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions and may violate laws including the Computer Fraud and Abuse Act (CFAA), the Computer Misuse Act, and equivalent legislation worldwide.

The authors assume no liability for misuse of this material. This project follows responsible disclosure practices.
