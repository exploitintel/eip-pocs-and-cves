# CVE-2024-56143 Lab

> Strapi 5 — IDOR via lookup Parameter Injection

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc.py` | Blind bcrypt password hash extraction |
| 2 | `poc_vector2.py` | Admin email enumeration via createdBy/updatedBy |
| 3 | `poc_vector3.py` | Full account takeover: email + reset token + password reset |

## Setup

```bash
cd CVE-2024-56143
docker compose up -d
```

Wait ~30-60s for health check (auto-configures admin, content type, permissions).

**Ports:** `1337 → Strapi 5.5.1`
**Credentials:** `admin@lab.local:Admin12345!`

## Run

```bash
python3 poc.py localhost 1337 articles
python3 poc_vector2.py localhost 1337 articles
python3 poc_vector3.py localhost 1337 articles
```

Note: Vector 3 changes the admin password to `Pwned12345!` — run last.

## Teardown

```bash
docker compose down -v
```
