# docker-compose.yml — CVE-2024-56143 Lab Environment
#
# Strapi 5.5.1 (vulnerable) with SQLite — IDOR via lookup parameter injection
#
# Usage:
#   docker compose up -d
#   docker compose down

services:
  vulnerable:
    image: ghcr.io/exploitintel/cve-2024-56143-vulnerable:latest
    container_name: cve-2024-56143-vulnerable
    environment:
      - NODE_ENV=development
      - HOST=0.0.0.0
      - PORT=1337
      - APP_KEYS=labKey1base64,labKey2base64,labKey3base64,labKey4base64
      - API_TOKEN_SALT=lab-api-token-salt-12345678
      - ADMIN_JWT_SECRET=lab-admin-jwt-secret-12345
      - TRANSFER_TOKEN_SALT=lab-transfer-salt-123456
      - JWT_SECRET=lab-jwt-secret-1234567890
    ports:
      - "1337:1337"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      - lab-net
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:1337/_health"]
      interval: 10s
      timeout: 5s
      retries: 30
      start_period: 60s

networks:
  lab-net:
    driver: bridge
