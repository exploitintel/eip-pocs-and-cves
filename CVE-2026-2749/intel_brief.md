# Intel Brief: CVE-2026-2749

## CVE Overview

| Field | Value |
|-------|-------|
| **CVE ID** | CVE-2026-2749 |
| **Title** | Centreon Open Tickets — Path Traversal in File Upload/Remove Actions |
| **Affected Software** | Centreon Open Tickets (module for Centreon) |
| **Vendor** | Centreon |
| **CVSS Score** | 9.9 (Critical) |
| **CVSS Vector** | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H |
| **CWE** | CWE-22 (Improper Limitation of a Pathname to a Restricted Directory — Path Traversal) |
| **Published** | 2026-02-27 |
| **Attack Vector** | Network (authenticated) |

## Description

Centreon Open Tickets, a module for the Centreon monitoring platform, contains a **path traversal vulnerability** in its file upload and file removal AJAX endpoints. An **authenticated user** (any valid Centreon session) can:

1. **Write arbitrary files** on the server by manipulating the uploaded filename (`$file['name']`) in the `uploadFile.php` action. The filename is used directly in path construction without sanitization, enabling directory traversal (e.g., `../../etc/cron.d/backdoor`).
2. **Delete arbitrary files** on the server by manipulating the `filename` parameter in the `removeFile.php` action. The parameter is passed directly to `unlink()` without path validation.

This can lead to **Remote Code Execution (RCE)** by writing malicious PHP files to the web root or cron jobs to `/etc/cron.d/`, and **Denial of Service (DoS)** by deleting critical system or application files.

## Affected Versions

| Branch | Vulnerable Versions | Fixed Version |
|--------|-------------------|---------------|
| 25.10.x | All versions before 25.10.3 | **25.10.3** |
| 24.10.x | All versions before 24.10.8 | **24.10.8** |
| 24.04.x | All versions before 24.04.7 | **24.04.7** |

## Repository Information

| Field | Value |
|-------|-------|
| **Repository URL** | https://github.com/centreon/centreon.git |
| **Repository Type** | Monorepo (centreon-web + centreon-open-tickets + other modules) |
| **Module Path** | `centreon-open-tickets/` |
| **Vulnerable Version Tag** | `centreon-open-tickets-25.10.2` |
| **Patched Version Tag** | `centreon-open-tickets-25.10.3` |
| **Fix Commit (hotfix branch)** | `93782a36463a0dcd593adc28821e4693d527f108` — PR #9670 |
| **Fix Commit (develop branch)** | `b07abb9d98699c25933a6f00ccd7cec08bda67ae` — PR #9654 |
| **Checked Out At** | `centreon-open-tickets-25.10.2` (vulnerable) |

## Vulnerable Code Analysis

### Vulnerable Files
Both files are in: `centreon-open-tickets/www/modules/centreon-open-tickets/views/rules/ajax/actions/`

#### 1. `uploadFile.php` (Arbitrary File Write)

```php
$uniq_id = $_REQUEST['uniqId'];               // No validation
foreach ($_FILES as $file) {
    $dir = dirname($file['tmp_name']);
    $file_dst = $dir . '/opentickets/' . $uniq_id . '__' . $file['name'];  // Path traversal via $file['name']
    @mkdir($dir . '/opentickets', 0750);
    if (rename($file['tmp_name'], $file_dst)) {     // rename() not move_uploaded_file()
        // ...
        $_SESSION['ot_upload_files'][$uniq_id][$file_dst] = 1;
    }
}
```

**Vulnerabilities:**
- `$file['name']` from `$_FILES` is used directly without `basename()` — can contain `../` sequences
- `$uniq_id` from `$_REQUEST` is not validated — can also contain `../` sequences
- Uses `rename()` instead of `move_uploaded_file()` (no upload verification)
- No `realpath()` check to prevent traversal

#### 2. `removeFile.php` (Arbitrary File Deletion)

```php
$temp_dir = sys_get_temp_dir();
unlink($temp_dir . '/opentickets/' . $get_information['uniqId'] . '__' . $get_information['filename']);
unset($_SESSION['ot_upload_files'][$get_information['uniqId']]);
```

**Vulnerabilities:**
- `$get_information['filename']` is used directly in path construction — can contain `../` sequences
- `$get_information['uniqId']` is not validated — can also contain `../` sequences
- Direct `unlink()` call with no path validation
- No `realpath()` check

### Entry Point / Routing

The vulnerable actions are accessed via **`call.php`** router:
- **URL Pattern**: `POST /centreon/modules/centreon-open-tickets/views/rules/ajax/call.php`
- **Upload Action**: `action=upload-file` (multipart/form-data with `$_REQUEST['uniqId']` and `$_FILES`)
- **Remove Action**: `action=remove-file` (POST with JSON body `{"action":"remove-file","uniqId":"...","filename":"..."}`)

**Authentication**: `call.php` checks `$_SESSION['centreon']` and calls `exit` if not set, so a valid Centreon authenticated session is **required**. However, any authenticated user (including low-privilege users) can exploit this.

### Fix Summary (commit 93782a3646)

The fix adds:
1. **Session validation** in each action file (`$_SESSION['centreon']` check)
2. **Input validation**: `basename()` on filenames, regex validation on `uniqId` (`/^[a-f0-9]{13}(\.[0-9]{8})?$/D`)
3. **Path validation**: `realpath()` + `str_starts_with()` to ensure paths stay within the target directory
4. **Upload security**: `move_uploaded_file()` instead of `rename()`
5. **Session tracking**: Verifies file path exists in session before allowing deletion

## Build System & Lab Notes

| Field | Value |
|-------|-------|
| **Primary Language** | PHP 8.2 |
| **Build System** | Composer (PHP) + nfpm (RPM/DEB packaging) |
| **Web Server** | Apache httpd with mod_php / php-fpm |
| **Database** | MariaDB 10.11 (for Centreon core) |
| **OS Target** | AlmaLinux 9 (or Debian Bookworm) |
| **Install Path** | `/usr/share/centreon/www/modules/centreon-open-tickets/` |

### Key Dependencies
- PHP 8.2 with extensions: curl, ctype, fileinfo, filter, gettext, intl, json, openssl, mbstring, pdo, session
- Apache httpd (with Centreon PHP application configured)
- MariaDB/MySQL (Centreon configuration database)
- Centreon Web (base platform — the Open Tickets module runs on top of it)

### Docker Lab Strategy

The Centreon project provides Docker infrastructure at `.github/docker/`:
- **Base web image**: `docker.centreon.com/centreon/centreon-web-alma9:<version>` (private registry)
- **Open Tickets Dockerfile**: `.github/docker/centreon-open-tickets/Dockerfile` — builds on top of web image
- **Docker Compose**: `.github/docker/docker-compose.yml` — full stack (web + db + optional services)

**Recommended lab approach**: Since the Centreon Docker images are in a private registry, the lab should:
1. Use a base AlmaLinux 9 or PHP 8.2 image
2. Install Centreon from official RPM packages (or use the community install script)
3. Install the Open Tickets module at the vulnerable version
4. Alternatively, create a **minimal PHP reproduction** that extracts just the vulnerable `uploadFile.php` and `removeFile.php` actions with a mock session, avoiding the full Centreon stack

### Minimal PoC Approach (Recommended)

Since the vulnerability is in standalone PHP files with minimal dependencies, a **minimal reproduction** is feasible:
- Set up a PHP 8.2 + Apache container
- Deploy only the vulnerable `uploadFile.php` and `removeFile.php` files
- Create a minimal `call.php` wrapper that sets up session and routes to the actions
- The PoC script sends crafted multipart upload requests with path traversal filenames

## Public Exploits

**No public exploits found** in EIP (ExploitDB, GitHub, Metasploit, etc.) as of 2026-02-28. This CVE was published on 2026-02-27 and is very recent.

## Attack Scenarios

### Scenario 1: Arbitrary File Write → RCE
1. Authenticate to Centreon with any valid account
2. Send a multipart POST to the upload endpoint with:
   - `action=upload-file`
   - `uniqId=abcdef1234567`
   - File with name `../../../usr/share/centreon/www/shell.php` containing PHP webshell
3. The file is written to `/tmp/opentickets/../../../usr/share/centreon/www/shell.php` → `/usr/share/centreon/www/shell.php`
4. Access `http://target/centreon/shell.php` for RCE

### Scenario 2: Arbitrary File Delete → DoS
1. Authenticate to Centreon with any valid account
2. Send POST to the remove endpoint with:
   - `action=remove-file`
   - JSON body: `{"action":"remove-file","uniqId":"a","filename":"../../usr/share/centreon/www/index.php"}`
3. The target file is deleted, causing application disruption

## References

| Source | URL |
|--------|-----|
| Centreon Security Bulletin | https://thewatch.centreon.com/latest-security-bulletins-64/cve-2026-2749-centreon-open-tickets-critical-severity-5493 |
| GitHub Advisory (GHSA) | https://github.com/advisories/GHSA-p9c8-78v7-93hh |
| CVE Record | https://www.cve.org/cverecord?id=CVE-2026-2749 |
| Fix Commit (25.10 branch) | https://github.com/centreon/centreon/commit/93782a36463a0dcd593adc28821e4693d527f108 |
| Fix Commit (develop branch) | https://github.com/centreon/centreon/commit/b07abb9d98699c25933a6f00ccd7cec08bda67ae |
| Source Repository | https://github.com/centreon/centreon |
