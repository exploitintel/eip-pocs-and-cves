# CVE-2026-28372 Lab

> GNU inetutils telnetd < 2.7 â€” Local Privilege Escalation via CREDENTIALS_DIRECTORY Injection

## Vectors

| # | Script | Description |
|---|--------|-------------|
| 1 | `poc/poc.py` | Full exploit: CREDENTIALS_DIRECTORY injection via NEW_ENVIRON â†’ root shell |
| 2 | `poc/control_test.py` | Control test: connect without exploit (proves auth required) |

## Setup

```bash
cd CVE-2026-28372
docker compose build && docker compose up -d
```

Wait ~10s for telnetd startup. Verify: `docker compose ps`

**Ports:** 2323 (GNU inetutils telnetd v2.7)
**Credentials:** root:Sup3rS3cretR00t!, weakuser:weakuser

## Run

```bash
# Primary exploit (obtain root shell without password)
python3 poc/poc.py localhost -p 2323

# Verbose output (shows Telnet negotiation)
python3 poc/poc.py localhost -p 2323 -v

# Control test (proves authentication normally required)
python3 poc/control_test.py localhost 2323
```

**Note:** Both PoCs use Python stdlib only (no dependencies).

## Teardown

```bash
docker compose down -v
```
